<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grace Community Church - Complete Management System</title>
    
    <!-- Meta Tags -->
    <meta name="description" content="Grace Community Church Management System - Comprehensive tools for church administration, member management, events, and communications.">
    <meta name="keywords" content="church, management, system, members, events, donations, ministry">
    <meta name="author" content="Grace Community Church">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#6f42c1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Grace Church">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="assets/logo.png">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        /* Custom CSS Variables */
        :root {
            --primary-color: #6f42c1;
            --secondary-color: #6c757d;
            --success-color: #198754;
            --info-color: #0dcaf0;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --light-color: #f8f9fa;
            --dark-color: #212529;
            --gradient-primary: linear-gradient(135deg, #6f42c1 0%, #5a32a3 100%);
            --gradient-secondary: linear-gradient(135deg, #6c757d 0%, #545b62 100%);
            --shadow-sm: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
            --shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
            --shadow-lg: 0 1rem 3rem rgba(0, 0, 0, 0.175);
        }

        /* Global Styles */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark-color);
            padding-top: 76px;
        }

        /* Navigation Styles */
        .navbar {
            background: var(--gradient-primary) !important;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: .5rem;
        }

        .navbar-brand .brand-logo {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid rgba(255,255,255,.6);
            background: #fff;
        }

        .navbar-brand .brand-text {
            color: #fff;
        }

        .navbar-nav .nav-link {
            font-weight: 500;
            margin: 0 0.5rem;
            transition: all 0.3s ease;
        }

        .navbar-nav .nav-link:hover {
            color: #fff !important;
            transform: translateY(-2px);
        }

        .navbar-nav .nav-link.active {
            color: #fff !important;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 6px;
        }

        /* Hero Section */
        .hero-section {
            background: var(--gradient-primary);
            color: white;
            min-height: 100vh;
            display: flex;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="1" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            opacity: 0.1;
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        /* Feature Cards */
        .feature-card {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            border: none;
            height: 100%;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .card-icon {
            width: 60px;
            height: 60px;
            background: var(--gradient-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        /* Quick Actions */
        .quick-action-card {
            display: block;
            text-decoration: none;
            color: var(--dark-color);
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .quick-action-card:hover {
            color: var(--primary-color);
            border-color: var(--primary-color);
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .quick-action-card i {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--primary-color);
        }

        /* Service Times Card */
        .service-times-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: var(--shadow-lg);
        }

        /* Content Sections */
        .content-section {
            padding: 4rem 0;
            min-height: 80vh;
        }

        .section-title {
            text-align: center;
            margin-bottom: 3rem;
        }

        .section-title h2 {
            color: var(--primary-color);
            font-weight: 700;
            margin-bottom: 1rem;
        }

        /* Admin Sidebar */
        .admin-sidebar {
            background: var(--gradient-primary);
            border-radius: 12px;
            position: sticky;
            top: 100px;
            max-height: calc(100vh - 120px);
            overflow-y: auto;
        }

        .admin-sidebar .nav-link {
            color: rgba(255, 255, 255, 0.8);
            border-radius: 8px;
            margin-bottom: 0.5rem;
            transition: all 0.3s ease;
        }

        .admin-sidebar .nav-link:hover,
        .admin-sidebar .nav-link.active {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        /* Tables */
        .table {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .table thead th {
            background: var(--primary-color);
            color: white;
            border: none;
            font-weight: 600;
        }

        /* Forms */
        .form-control,
        .form-select {
            border-radius: 8px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .form-control:focus,
        .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(111, 66, 193, 0.25);
        }

        /* Buttons */
        .btn {
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: var(--gradient-primary);
            border: none;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        /* Animations */
        .fade-in-up {
            animation: fadeInUp 0.6s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Loading Overlay */
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        /* Enhanced Mobile Optimizations */
        @media (max-width: 768px) {
            body {
                padding-top: 70px;
            }

            .hero-section {
                min-height: 80vh;
                text-align: center;
                padding: 2rem 0;
            }

            .hero-section .display-4 {
                font-size: 2rem;
                line-height: 1.2;
            }

            .hero-section .lead {
                font-size: 1rem;
            }

            .service-times-card {
                margin-top: 2rem;
                padding: 1.5rem;
            }

            .quick-action-card {
                padding: 1rem;
                min-height: 100px;
                margin-bottom: 1rem;
            }

            .quick-action-card i {
                font-size: 1.8rem;
                margin-bottom: 0.5rem;
            }

            .quick-action-card span {
                font-size: 0.875rem;
            }

            .navbar-nav {
                text-align: center;
                padding: 1rem 0;
            }

            .navbar-nav .nav-item {
                margin: 0.25rem 0;
            }

            .navbar-nav .nav-link {
                padding: 0.75rem 1rem;
                border-radius: 8px;
                margin: 0.25rem;
            }

            .table-responsive {
                font-size: 0.8rem;
            }

            .table th, .table td {
                padding: 0.5rem 0.25rem;
                vertical-align: middle;
            }

            .feature-card {
                margin-bottom: 1.5rem;
                padding: 1.5rem;
            }

            .card-icon {
                width: 50px;
                height: 50px;
                font-size: 1.25rem;
            }

            .form-control, .form-select {
                font-size: 16px; /* Prevents zoom on iOS */
                padding: 0.75rem;
            }

            .btn {
                padding: 0.75rem 1rem;
                font-size: 0.9rem;
            }

            .btn-group-vertical .btn {
                margin-bottom: 0.5rem;
            }

            .modal-dialog {
                margin: 0.5rem;
            }

            .modal-body {
                padding: 1rem;
            }

            .admin-sidebar {
                position: static;
                margin-bottom: 2rem;
            }

            .section-title h2 {
                font-size: 1.75rem;
            }

            .section-title p {
                font-size: 0.95rem;
            }

            /* Mobile-specific button groups */
            .btn-group {
                flex-wrap: wrap;
                gap: 0.5rem;
            }

            .btn-group .btn {
                flex: 1;
                min-width: auto;
            }

            /* Mobile table improvements */
            .table-responsive table {
                min-width: 600px;
            }

            /* Mobile card improvements */
            .event-item .row {
                align-items: flex-start;
            }

            .event-date {
                margin-bottom: 1rem;
            }

            /* Mobile form improvements */
            .row.g-3 > .col-md-6 {
                margin-bottom: 1rem;
            }

            /* Mobile stats improvements */
            .stat-item h4 {
                font-size: 1.5rem;
            }
        }

        /* Tablet Optimizations */
        @media (min-width: 769px) and (max-width: 1024px) {
            .hero-section .display-4 {
                font-size: 2.5rem;
            }

            .quick-action-card {
                min-height: 110px;
            }

            .feature-card {
                padding: 1.75rem;
            }

            .admin-sidebar {
                position: sticky;
                top: 90px;
            }
        }

        /* Large Screen Optimizations */
        @media (min-width: 1200px) {
            .container {
                max-width: 1140px;
            }

            .hero-section .display-4 {
                font-size: 3.5rem;
            }

            .feature-card {
                padding: 2.5rem;
            }

            .quick-action-card {
                min-height: 140px;
            }

            .quick-action-card i {
                font-size: 3rem;
            }
        }

        /* Ultra-wide Screen Optimizations */
        @media (min-width: 1400px) {
            .container {
                max-width: 1320px;
            }

            .hero-section {
                min-height: 100vh;
            }
        }

        /* Print Styles */
        @media print {
            .navbar,
            .quick-actions,
            footer {
                display: none !important;
            }
            
            body {
                padding-top: 0;
            }
            
            .hero-section {
                min-height: auto;
                padding: 2rem 0;
            }
            
            .feature-card {
                break-inside: avoid;
                margin-bottom: 1rem;
            }
        }

        /* Additional Component Styles */
        .event-card {
            border-left: 4px solid var(--primary-color);
        }

        .event-date {
            background: var(--primary-color);
            color: white;
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
        }

        .event-date .day {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .event-date .month {
            font-size: 0.875rem;
            text-transform: uppercase;
        }

        .member-avatar {
            text-align: center;
        }

        .sermon-thumbnail {
            position: relative;
            overflow: hidden;
            border-radius: 8px;
        }

        .play-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .sermon-thumbnail:hover .play-overlay {
            opacity: 1;
        }

        .duration-badge {
            position: absolute;
            bottom: 8px;
            right: 8px;
        }

        .media-folder {
            text-align: center;
            padding: 1rem;
            border: 2px dashed #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .media-folder:hover {
            border-color: var(--primary-color);
            background: rgba(111, 66, 193, 0.05);
        }

        .media-item {
            position: relative;
        }

        .media-thumbnail {
            position: relative;
            overflow: hidden;
            border-radius: 8px;
            aspect-ratio: 1;
        }

        .media-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .media-thumbnail:hover .media-overlay {
            opacity: 1;
        }

        .file-icon {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 9999;
        }

        /* Calendar Styles */
        .calendar-container {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
        }

        .calendar-grid {
            display: grid;
            gap: 1px;
            background: #dee2e6;
            border-radius: 8px;
            overflow: hidden;
        }

        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
        }

        .calendar-weekday {
            background: var(--primary-color);
            color: white;
            padding: 0.75rem;
            text-align: center;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
        }

        .calendar-day {
            background: white;
            padding: 0.75rem;
            min-height: 80px;
            position: relative;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .calendar-day:hover {
            background: rgba(111, 66, 193, 0.05);
        }

        .calendar-day.today {
            background: rgba(111, 66, 193, 0.1);
        }

        .calendar-day.other-month {
            color: #6c757d;
            background: #f8f9fa;
        }

        .day-number {
            font-weight: 600;
        }

        .event-indicator {
            position: absolute;
            top: 4px;
            right: 4px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#home">
                <img src="assets/logo.png" alt="Logo" class="brand-logo me-1"> <span class="brand-text">Grace Community Church</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#home">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#about">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#events">Events</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#members">Members</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#ministries">Ministries</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#media">Media</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#communications">Communications</a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i class="bi bi-person me-1"></i>Login
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link btn btn-outline-light ms-2 px-3" href="#admin">
                            <i class="bi bi-gear me-1"></i>Admin
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <div id="content-area">
        <!-- Hero Section -->
        <section class="hero-section" id="home">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-8">
                        <div class="hero-content">
                            <h1 class="display-4 fw-bold text-white mb-4">Church Management System</h1>
                            <p class="lead text-white mb-4">Comprehensive tools for church administrators, staff, and ministry leaders to manage operations efficiently.</p>
                            <div class="d-flex flex-wrap gap-3">
                                <a href="#admin" class="btn btn-light btn-lg">
                                    <i class="bi bi-speedometer2 me-2"></i>Admin Dashboard
                                </a>
                                <a href="#members" class="btn btn-outline-light btn-lg">
                                    <i class="bi bi-people me-2"></i>Manage Members
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="service-times-card">
                            <h4 class="text-primary mb-3">
                                <i class="bi bi-clock me-2"></i>Service Times
                            </h4>
                            <div class="service-time mb-3">
                                <h6 class="mb-1">Sunday Morning Worship</h6>
                                <p class="mb-0 text-muted">9:00 AM & 11:00 AM</p>
                            </div>
                            <div class="service-time mb-3">
                                <h6 class="mb-1">Wednesday Bible Study</h6>
                                <p class="mb-0 text-muted">7:00 PM</p>
                            </div>
                            <div class="service-time">
                                <h6 class="mb-1">Youth Group</h6>
                                <p class="mb-0 text-muted">Friday 6:30 PM</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quick Actions -->
        <section class="py-5 bg-light">
            <div class="container">
                <div class="row g-4">
                    <div class="col-md-3 col-6">
                        <a href="#events" class="quick-action-card">
                            <i class="bi bi-calendar-event"></i>
                            <span>Manage Events</span>
                        </a>
                    </div>
                    <div class="col-md-3 col-6">
                        <a href="#members" class="quick-action-card">
                            <i class="bi bi-people"></i>
                            <span>Member Directory</span>
                        </a>
                    </div>
                    <div class="col-md-3 col-6">
                        <a href="#offerings" class="quick-action-card">
                            <i class="bi bi-cash-stack"></i>
                            <span>Manage Offerings</span>
                        </a>
                    </div>
                    <div class="col-md-3 col-6">
                        <a href="#communications" class="quick-action-card">
                            <i class="bi bi-envelope-at"></i>
                            <span>Communications</span>
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Overview -->
        <section class="py-5">
            <div class="container">
                <div class="section-title">
                    <h2>Management Features</h2>
                    <p>Comprehensive tools for effective church administration</p>
                </div>
                <div class="row g-4">
                    <div class="col-lg-4 col-md-6">
                        <div class="feature-card text-center">
                            <div class="card-icon mx-auto">
                                <i class="bi bi-people"></i>
                            </div>
                            <h5>Member Management</h5>
                            <p>Complete member database with profiles, directory, and communication tools.</p>
                            <a href="#members" class="btn btn-outline-primary">Manage Members</a>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="feature-card text-center">
                            <div class="card-icon mx-auto">
                                <i class="bi bi-calendar-event"></i>
                            </div>
                            <h5>Event Planning</h5>
                            <p>Create, manage, and track church events with RSVP and attendance features.</p>
                            <a href="#events" class="btn btn-outline-primary">Manage Events</a>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="feature-card text-center">
                            <div class="card-icon mx-auto">
                                <i class="bi bi-cash-stack"></i>
                            </div>
                            <h5>Financial Tracking</h5>
                            <p>Record offerings, track donations, and generate financial reports.</p>
                            <a href="#offerings" class="btn btn-outline-primary">View Finances</a>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="feature-card text-center">
                            <div class="card-icon mx-auto">
                                <i class="bi bi-diagram-3"></i>
                            </div>
                            <h5>Ministry Oversight</h5>
                            <p>Coordinate ministries, manage volunteers, and track involvement.</p>
                            <a href="#ministries" class="btn btn-outline-primary">View Ministries</a>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="feature-card text-center">
                            <div class="card-icon mx-auto">
                                <i class="bi bi-envelope-at"></i>
                            </div>
                            <h5>Communications</h5>
                            <p>Send announcements, newsletters, and manage prayer requests.</p>
                            <a href="#communications" class="btn btn-outline-primary">Communications</a>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="feature-card text-center">
                            <div class="card-icon mx-auto">
                                <i class="bi bi-play-circle"></i>
                            </div>
                            <h5>Media Library</h5>
                            <p>Organize sermons, photos, documents, and live streaming.</p>
                            <a href="#media" class="btn btn-outline-primary">Media Center</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Login Modal -->
    <div class="modal fade" id="loginModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Admin Login</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="loginForm">
                        <div class="mb-3">
                            <label for="username" class="form-label">Username</label>
                            <input type="text" class="form-control" id="username" required>
                        </div>
                        <div class="mb-3">
                            <label for="password" class="form-label">Password</label>
                            <input type="password" class="form-control" id="password" required>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="rememberMe">
                            <label class="form-check-label" for="rememberMe">
                                Remember me
                            </label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" form="loginForm" class="btn btn-primary">
                        <i class="bi bi-box-arrow-in-right me-1"></i>Login
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container"></div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white py-4 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-4">
                    <h5><i class="bi bi-church me-2"></i>Grace Community Church</h5>
                    <p class="mb-2">123 Faith Street<br>Your City, ST 12345</p>
                    <p class="mb-0">
                        <i class="bi bi-telephone me-2"></i>(555) 123-4567<br>
                        <i class="bi bi-envelope me-2"></i>info@gracecommunity.org
                    </p>
                </div>
                <div class="col-lg-4">
                    <h6>Quick Links</h6>
                    <ul class="list-unstyled">
                        <li><a href="#about" class="text-white-50">About Us</a></li>
                        <li><a href="#events" class="text-white-50">Events</a></li>
                        <li><a href="#ministries" class="text-white-50">Ministries</a></li>
                        <li><a href="#media" class="text-white-50">Sermons</a></li>
                    </ul>
                </div>
                <div class="col-lg-4">
                    <h6>Connect With Us</h6>
                    <div class="social-links">
                        <a href="#" class="text-white me-3"><i class="bi bi-facebook"></i></a>
                        <a href="#" class="text-white me-3"><i class="bi bi-instagram"></i></a>
                        <a href="#" class="text-white me-3"><i class="bi bi-youtube"></i></a>
                        <a href="#" class="text-white"><i class="bi bi-envelope"></i></a>
                    </div>
                    <p class="mt-3 mb-0 small">© 2024 Grace Community Church. All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Church Management System - Complete JavaScript

        // Global Variables
        let currentUser = null;
        let currentSection = 'home';
        let churchData = {
            members: [],
            events: [],
            offerings: [],
            ministries: [],
            communications: []
        };

        // UI Components Class
        class UIComponents {
            constructor() {
                this.toastContainer = document.querySelector('.toast-container');
                if (!this.toastContainer) {
                    this.toastContainer = document.createElement('div');
                    this.toastContainer.className = 'toast-container';
                    document.body.appendChild(this.toastContainer);
                }
            }

            showToast(message, type = 'info', duration = 5000) {
                const toastId = 'toast_' + Date.now();
                const bgClass = {
                    'success': 'bg-success',
                    'error': 'bg-danger',
                    'warning': 'bg-warning',
                    'info': 'bg-info'
                }[type] || 'bg-info';

                const toastHTML = `
                    <div id="${toastId}" class="toast align-items-center text-white ${bgClass} border-0" role="alert">
                        <div class="d-flex">
                            <div class="toast-body">
                                <i class="bi bi-${this.getToastIcon(type)} me-2"></i>${message}
                            </div>
                            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                        </div>
                    </div>
                `;

                this.toastContainer.insertAdjacentHTML('beforeend', toastHTML);
                const toastElement = document.getElementById(toastId);
                const toast = new bootstrap.Toast(toastElement, { delay: duration });
                toast.show();

                toastElement.addEventListener('hidden.bs.toast', () => {
                    toastElement.remove();
                });
            }

            getToastIcon(type) {
                const icons = {
                    'success': 'check-circle',
                    'error': 'exclamation-triangle',
                    'warning': 'exclamation-triangle',
                    'info': 'info-circle'
                };
                return icons[type] || 'info-circle';
            }

            showLoading() {
                document.getElementById('loadingOverlay').style.display = 'flex';
            }

            hideLoading() {
                document.getElementById('loadingOverlay').style.display = 'none';
            }

            createModal(id, title, content, size = '') {
                const modalHTML = `
                    <div class="modal fade" id="${id}" tabindex="-1">
                        <div class="modal-dialog ${size}">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">${title}</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>
                                <div class="modal-body">
                                    ${content}
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                // Remove existing modal if present
                const existingModal = document.getElementById(id);
                if (existingModal) {
                    existingModal.remove();
                }

                document.body.insertAdjacentHTML('beforeend', modalHTML);
                return new bootstrap.Modal(document.getElementById(id));
            }

            createCalendar(events = []) {
                const now = new Date();
                const year = now.getFullYear();
                const month = now.getMonth();

                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const startDate = new Date(firstDay);
                startDate.setDate(startDate.getDate() - firstDay.getDay());

                const monthNames = [
                    'January', 'February', 'March', 'April', 'May', 'June',
                    'July', 'August', 'September', 'October', 'November', 'December'
                ];

                const weekdays = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];

                let calendarHTML = `
                    <div class="calendar-container">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h4>${monthNames[month]} ${year}</h4>
                            <div class="btn-group">
                                <button class="btn btn-outline-primary btn-sm" onclick="changeMonth(-1)">
                                    <i class="bi bi-chevron-left"></i>
                                </button>
                                <button class="btn btn-outline-primary btn-sm" onclick="changeMonth(1)">
                                    <i class="bi bi-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                        <div class="calendar-grid">
                            <div class="calendar-weekdays">
                `;

                weekdays.forEach(day => {
                    calendarHTML += `<div class="calendar-weekday">${day}</div>`;
                });

                calendarHTML += `
                            </div>
                            <div class="calendar-days">
                `;

                const currentDate = new Date(startDate);
                for (let i = 0; i < 42; i++) {
                    const isCurrentMonth = currentDate.getMonth() === month;
                    const isToday = currentDate.toDateString() === now.toDateString();
                    const dayEvents = events.filter(event =>
                        new Date(event.date).toDateString() === currentDate.toDateString()
                    );

                    let dayClass = 'calendar-day';
                    if (!isCurrentMonth) dayClass += ' other-month';
                    if (isToday) dayClass += ' today';

                    calendarHTML += `
                        <div class="${dayClass}" data-date="${currentDate.toISOString().split('T')[0]}">
                            <div class="day-number">${currentDate.getDate()}</div>
                            ${dayEvents.length > 0 ? `<div class="event-indicator">${dayEvents.length}</div>` : ''}
                        </div>
                    `;

                    currentDate.setDate(currentDate.getDate() + 1);
                }

                calendarHTML += `
                            </div>
                        </div>
                    </div>
                `;

                return calendarHTML;
            }
        }

        // Initialize UI Components
        const uiComponents = new UIComponents();

        // Church Admin Class
        class ChurchAdmin {
            constructor() {
                this.currentUser = null;
                this.permissions = [];
                this.init();
            }

            init() {
                this.loadUserPermissions();
                this.setupEventListeners();
                this.loadSampleData();
            }

            loadUserPermissions() {
                this.currentUser = this.getFromStorage('currentUser') || {
                    name: 'Admin User',
                    email: 'admin@gracecommunity.org',
                    permissions: ['read', 'write', 'admin']
                };
                this.permissions = this.currentUser.permissions || ['read', 'write', 'admin'];
            }

            setupEventListeners() {
                // Login form
                const loginForm = document.getElementById('loginForm');
                if (loginForm) {
                    loginForm.addEventListener('submit', (e) => this.handleLogin(e));
                }

                // Navigation
                document.addEventListener('click', (e) => {
                    if (e.target.matches('a[href^="#"]')) {
                        e.preventDefault();
                        const section = e.target.getAttribute('href').substring(1);
                        this.loadSection(section);
                    }
                });

                // Window events
                window.addEventListener('popstate', (e) => {
                    if (e.state && e.state.section) {
                        this.loadSection(e.state.section, false);
                    }
                });
            }

            loadSampleData() {
                // Load sample data if not exists
                if (!this.getFromStorage('members')) {
                    const sampleMembers = [
                        {
                            id: 'mem001',
                            firstName: 'John',
                            lastName: 'Smith',
                            email: 'john.smith@email.com',
                            phone: '(555) 123-4567',
                            membershipType: 'member',
                            joinDate: '2020-01-15',
                            ministries: ['worship', 'leadership'],
                            status: 'active'
                        },
                        {
                            id: 'mem002',
                            firstName: 'Sarah',
                            lastName: 'Johnson',
                            email: 'sarah.johnson@email.com',
                            phone: '(555) 234-5678',
                            membershipType: 'member',
                            joinDate: '2019-03-22',
                            ministries: ['youth', 'children'],
                            status: 'active'
                        }
                    ];
                    this.saveToStorage('members', sampleMembers);
                }

                if (!this.getFromStorage('events')) {
                    const sampleEvents = [
                        {
                            id: 'evt001',
                            title: 'Christmas Eve Service',
                            date: '2024-12-24',
                            time: '19:00',
                            location: 'Main Sanctuary',
                            description: 'Join us for our special Christmas Eve candlelight service.',
                            category: 'worship',
                            attendees: 127
                        },
                        {
                            id: 'evt002',
                            title: 'Youth Christmas Party',
                            date: '2024-12-15',
                            time: '18:30',
                            location: 'Youth Center',
                            description: 'Fun-filled evening for our youth group.',
                            category: 'youth',
                            attendees: 23
                        }
                    ];
                    this.saveToStorage('events', sampleEvents);
                }

                if (!this.getFromStorage('offerings')) {
                    const sampleOfferings = [
                        {
                            id: 'off001',
                            date: '2024-12-10',
                            service: 'sunday-11am',
                            cashAmount: 1250.00,
                            checkAmount: 3200.00,
                            onlineAmount: 850.00,
                            totalAmount: 5300.00,
                            fund: 'general',
                            recordedBy: 'John Smith'
                        }
                    ];
                    this.saveToStorage('offerings', sampleOfferings);
                }
            }

            handleLogin(e) {
                e.preventDefault();
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;

                // Simple demo login (in production, use proper authentication)
                if (username === 'admin' && password === 'admin') {
                    this.currentUser = {
                        name: 'Admin User',
                        email: 'admin@gracecommunity.org',
                        permissions: ['read', 'write', 'admin']
                    };
                    this.saveToStorage('currentUser', this.currentUser);

                    const modal = bootstrap.Modal.getInstance(document.getElementById('loginModal'));
                    modal.hide();

                    uiComponents.showToast('Login successful!', 'success');
                    this.loadSection('admin');
                } else {
                    uiComponents.showToast('Invalid credentials. Use admin/admin for demo.', 'error');
                }
            }

            loadSection(section, updateHistory = true) {
                currentSection = section;

                if (updateHistory) {
                    history.pushState({section: section}, '', `#${section}`);
                }

                this.updateActiveNavigation(section);

                uiComponents.showLoading();

                setTimeout(() => {
                    this.renderSection(section);
                    uiComponents.hideLoading();
                }, 300);
            }

            updateActiveNavigation(activeSection) {
                document.querySelectorAll('.navbar-nav .nav-link').forEach(link => {
                    link.classList.remove('active');
                });

                const activeLink = document.querySelector(`.navbar-nav .nav-link[href="#${activeSection}"]`);
                if (activeLink) {
                    activeLink.classList.add('active');
                }
            }

            renderSection(section) {
                const contentArea = document.getElementById('content-area');
                let html = '';

                switch(section) {
                    case 'about':
                        html = this.renderAboutSection();
                        break;
                    case 'events':
                        html = this.renderEventsSection();
                        break;
                    case 'members':
                        html = this.renderMembersSection();
                        break;
                    case 'offerings':
                        html = this.renderOfferingsSection();
                        break;
                    case 'ministries':
                        html = this.renderMinistriesSection();
                        break;
                    case 'communications':
                        html = this.renderCommunicationsSection();
                        break;
                    case 'media':
                        html = this.renderMediaSection();
                        break;
                    case 'admin':
                        html = this.renderAdminSection();
                        break;
                    default:
                        return; // Keep home content
                }

                contentArea.innerHTML = html;
                contentArea.classList.add('fade-in-up');

                // Setup section-specific event listeners
                this.setupSectionEventListeners(section);
            }

            renderAboutSection() {
                return `
                    <section class="content-section">
                        <div class="container">
                            <div class="section-title">
                                <h2>About Grace Community Church</h2>
                                <p>Learn about our history, mission, and the people who make our church family special</p>
                            </div>

                            <div class="row align-items-center mb-5">
                                <div class="col-lg-6">
                                    <div class="bg-light rounded-3 p-4 text-center">
                                        <i class="bi bi-church text-primary" style="font-size: 8rem;"></i>
                                        <h4 class="mt-3">Our Church Building</h4>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <h3 class="text-primary mb-3">Our Story</h3>
                                    <p class="lead">Founded in 1985, Grace Community Church has been a beacon of hope and faith in our community for nearly four decades.</p>
                                    <p>We believe in creating an environment where people can have a life-changing experience with God. Our mission is to help people discover their purpose, develop their potential, and make a difference in their world.</p>
                                    <div class="row g-3 mt-3">
                                        <div class="col-6">
                                            <div class="stat-item text-center">
                                                <h4 class="text-primary mb-0">500+</h4>
                                                <small class="text-muted">Active Members</small>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="stat-item text-center">
                                                <h4 class="text-primary mb-0">15</h4>
                                                <small class="text-muted">Ministries</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row g-4 mb-5">
                                <div class="col-lg-4">
                                    <div class="feature-card text-center">
                                        <div class="card-icon mx-auto">
                                            <i class="bi bi-bullseye"></i>
                                        </div>
                                        <h5>Our Mission</h5>
                                        <p>To make disciples of Jesus Christ who love God, love others, and serve the world.</p>
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="feature-card text-center">
                                        <div class="card-icon mx-auto">
                                            <i class="bi bi-eye"></i>
                                        </div>
                                        <h5>Our Vision</h5>
                                        <p>To be a church that transforms lives and communities through the love of Christ.</p>
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="feature-card text-center">
                                        <div class="card-icon mx-auto">
                                            <i class="bi bi-heart"></i>
                                        </div>
                                        <h5>Our Values</h5>
                                        <p>Love, Grace, Community, Service, and Authentic Worship guide everything we do.</p>
                                    </div>
                                </div>
                            </div>

                            <div class="section-title">
                                <h3>Our Leadership Team</h3>
                                <p>Meet the dedicated leaders who guide our church community</p>
                            </div>

                            <div class="row g-4">
                                <div class="col-lg-4 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <div class="bg-primary rounded-circle mx-auto mb-3 d-flex align-items-center justify-content-center" style="width: 120px; height: 120px;">
                                                <i class="bi bi-person text-white" style="font-size: 3rem;"></i>
                                            </div>
                                            <h5>Pastor John Smith</h5>
                                            <p class="text-muted">Senior Pastor</p>
                                            <p class="small">Pastor John has been leading our congregation for over 15 years with wisdom, compassion, and dedication.</p>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-4 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <div class="bg-success rounded-circle mx-auto mb-3 d-flex align-items-center justify-content-center" style="width: 120px; height: 120px;">
                                                <i class="bi bi-person text-white" style="font-size: 3rem;"></i>
                                            </div>
                                            <h5>Pastor Sarah Johnson</h5>
                                            <p class="text-muted">Associate Pastor</p>
                                            <p class="small">Pastor Sarah oversees our youth and family ministries, bringing energy and innovation to our programs.</p>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-4 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <div class="bg-info rounded-circle mx-auto mb-3 d-flex align-items-center justify-content-center" style="width: 120px; height: 120px;">
                                                <i class="bi bi-person text-white" style="font-size: 3rem;"></i>
                                            </div>
                                            <h5>Michael Davis</h5>
                                            <p class="text-muted">Worship Leader</p>
                                            <p class="small">Michael leads our worship team and helps create meaningful worship experiences every Sunday.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                `;
            }

            renderEventsSection() {
                const events = this.getFromStorage('events') || [];

                return `
                    <section class="content-section">
                        <div class="container">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div>
                                    <h2>Event Management</h2>
                                    <p class="mb-0">Manage church events, registrations, and attendance tracking</p>
                                </div>
                                <div class="btn-group">
                                    <button class="btn btn-primary" onclick="churchAdmin.createNewEvent()">
                                        <i class="bi bi-plus me-1"></i>Create Event
                                    </button>
                                    <button class="btn btn-outline-primary" onclick="churchAdmin.exportEventData()">
                                        <i class="bi bi-download me-1"></i>Export Data
                                    </button>
                                </div>
                            </div>

                            <div class="row g-4 mb-4">
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-calendar-event text-primary fs-1 mb-2"></i>
                                            <h4 class="text-primary">${events.length}</h4>
                                            <h6>Total Events</h6>
                                            <small class="text-success">This month</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-people text-success fs-1 mb-2"></i>
                                            <h4 class="text-success">${events.reduce((sum, e) => sum + (e.attendees || 0), 0)}</h4>
                                            <h6>Total Attendees</h6>
                                            <small class="text-success">All events</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-calendar-check text-info fs-1 mb-2"></i>
                                            <h4 class="text-info">8</h4>
                                            <h6>Upcoming Events</h6>
                                            <small class="text-info">Next 30 days</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-graph-up text-warning fs-1 mb-2"></i>
                                            <h4 class="text-warning">95%</h4>
                                            <h6>Attendance Rate</h6>
                                            <small class="text-warning">Average</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row g-4">
                                <div class="col-lg-8">
                                    <div class="card feature-card">
                                        <div class="card-header d-flex justify-content-between align-items-center">
                                            <h5 class="mb-0">Upcoming Events</h5>
                                            <div class="btn-group btn-group-sm">
                                                <button class="btn btn-outline-primary active">List View</button>
                                                <button class="btn btn-outline-primary" onclick="churchAdmin.showCalendarView()">Calendar</button>
                                            </div>
                                        </div>
                                        <div class="card-body">
                                            ${this.renderEventsList(events)}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="card feature-card">
                                        <div class="card-header">
                                            <h6 class="mb-0">Quick Actions</h6>
                                        </div>
                                        <div class="card-body">
                                            <div class="d-grid gap-2">
                                                <button class="btn btn-primary" onclick="churchAdmin.createNewEvent()">
                                                    <i class="bi bi-plus me-1"></i>Create Event
                                                </button>
                                                <button class="btn btn-outline-primary" onclick="churchAdmin.manageRecurringEvents()">
                                                    <i class="bi bi-arrow-repeat me-1"></i>Recurring Events
                                                </button>
                                                <button class="btn btn-outline-secondary" onclick="churchAdmin.eventReports()">
                                                    <i class="bi bi-graph-up me-1"></i>Event Reports
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                `;
            }

            renderEventsList(events) {
                if (events.length === 0) {
                    return '<p class="text-muted text-center py-4">No events found. <a href="#" onclick="churchAdmin.createNewEvent()">Create your first event</a>.</p>';
                }

                return events.map(event => `
                    <div class="event-item border-bottom pb-3 mb-3">
                        <div class="row align-items-center">
                            <div class="col-md-2">
                                <div class="event-date text-center">
                                    <div class="day">${new Date(event.date).getDate()}</div>
                                    <div class="month">${new Date(event.date).toLocaleDateString('en-US', {month: 'short'}).toUpperCase()}</div>
                                </div>
                            </div>
                            <div class="col-md-7">
                                <h6 class="mb-1">${event.title}</h6>
                                <p class="mb-1 text-muted small">
                                    <i class="bi bi-clock me-1"></i>${event.time}
                                    <i class="bi bi-geo-alt ms-2 me-1"></i>${event.location}
                                </p>
                                <p class="mb-0 small">${event.description}</p>
                                <span class="badge bg-primary mt-1">${event.category}</span>
                            </div>
                            <div class="col-md-3 text-end">
                                <div class="mb-2">
                                    <small class="text-success">
                                        <i class="bi bi-people me-1"></i>${event.attendees || 0} attending
                                    </small>
                                </div>
                                <div class="btn-group btn-group-sm">
                                    <button class="btn btn-outline-primary" onclick="churchAdmin.editEvent('${event.id}')">
                                        <i class="bi bi-pencil"></i>
                                    </button>
                                    <button class="btn btn-outline-info" onclick="churchAdmin.viewEventDetails('${event.id}')">
                                        <i class="bi bi-eye"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            renderMembersSection() {
                const members = this.getFromStorage('members') || [];

                return `
                    <section class="content-section">
                        <div class="container">
                            <div class="section-title">
                                <h2>Member Management</h2>
                                <p>Comprehensive member database and management tools for church administrators</p>
                            </div>

                            <div class="row g-4 mb-5">
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-person-plus text-primary fs-1 mb-2"></i>
                                            <h4 class="text-primary">${members.length}</h4>
                                            <h6>Total Members</h6>
                                            <button class="btn btn-outline-primary btn-sm" onclick="churchAdmin.addNewMember()">
                                                <i class="bi bi-plus me-1"></i>Add New
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-person-check text-success fs-1 mb-2"></i>
                                            <h4 class="text-success">${members.filter(m => m.status === 'active').length}</h4>
                                            <h6>Active Members</h6>
                                            <button class="btn btn-outline-success btn-sm" onclick="churchAdmin.viewActiveMembers()">
                                                <i class="bi bi-eye me-1"></i>View List
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-person-exclamation text-warning fs-1 mb-2"></i>
                                            <h4 class="text-warning">3</h4>
                                            <h6>Pending Reviews</h6>
                                            <button class="btn btn-outline-warning btn-sm" onclick="churchAdmin.reviewPendingMembers()">
                                                <i class="bi bi-clipboard-check me-1"></i>Review
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-person-workspace text-info fs-1 mb-2"></i>
                                            <h4 class="text-info">${members.filter(m => m.ministries && m.ministries.length > 0).length}</h4>
                                            <h6>Volunteers</h6>
                                            <button class="btn btn-outline-info btn-sm" onclick="churchAdmin.manageVolunteers()">
                                                <i class="bi bi-gear me-1"></i>Manage
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row mb-4">
                                <div class="col-lg-8">
                                    <div class="btn-group me-3" role="group">
                                        <button class="btn btn-primary" onclick="churchAdmin.addNewMember()">
                                            <i class="bi bi-person-plus me-1"></i>Add Member
                                        </button>
                                        <button class="btn btn-outline-primary" onclick="churchAdmin.importMembers()">
                                            <i class="bi bi-upload me-1"></i>Import
                                        </button>
                                        <button class="btn btn-outline-primary" onclick="churchAdmin.exportMembers()">
                                            <i class="bi bi-download me-1"></i>Export
                                        </button>
                                    </div>
                                    <button class="btn btn-outline-secondary" onclick="churchAdmin.sendBulkEmail()">
                                        <i class="bi bi-envelope-at me-1"></i>Bulk Email
                                    </button>
                                </div>
                                <div class="col-lg-4">
                                    <div class="input-group">
                                        <input type="text" class="form-control" placeholder="Search members..." id="memberSearchAdmin">
                                        <button class="btn btn-outline-secondary" type="button">
                                            <i class="bi bi-search"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="card feature-card">
                                <div class="card-header">
                                    <h5 class="mb-0">Member Directory</h5>
                                </div>
                                <div class="card-body">
                                    ${this.renderMembersList(members)}
                                </div>
                            </div>
                        </div>
                    </section>
                `;
            }

            renderMembersList(members) {
                if (members.length === 0) {
                    return '<p class="text-muted text-center py-4">No members found. <a href="#" onclick="churchAdmin.addNewMember()">Add your first member</a>.</p>';
                }

                return `
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Membership</th>
                                    <th>Ministries</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${members.map(member => `
                                    <tr>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <div class="bg-primary rounded-circle me-2 d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                                                    <i class="bi bi-person text-white"></i>
                                                </div>
                                                <div>
                                                    <strong>${member.firstName} ${member.lastName}</strong>
                                                    <br><small class="text-muted">Joined: ${new Date(member.joinDate).toLocaleDateString()}</small>
                                                </div>
                                            </div>
                                        </td>
                                        <td>${member.email}</td>
                                        <td>${member.phone || 'N/A'}</td>
                                        <td><span class="badge bg-secondary">${member.membershipType}</span></td>
                                        <td>
                                            ${(member.ministries || []).map(ministry =>
                                                `<span class="badge bg-info me-1">${ministry}</span>`
                                            ).join('')}
                                        </td>
                                        <td><span class="badge bg-success">${member.status}</span></td>
                                        <td>
                                            <div class="btn-group btn-group-sm">
                                                <button class="btn btn-outline-primary" onclick="churchAdmin.editMember('${member.id}')" title="Edit">
                                                    <i class="bi bi-pencil"></i>
                                                </button>
                                                <button class="btn btn-outline-info" onclick="churchAdmin.viewMemberProfile('${member.id}')" title="View">
                                                    <i class="bi bi-eye"></i>
                                                </button>
                                                <button class="btn btn-outline-secondary" onclick="churchAdmin.contactMember('${member.id}')" title="Contact">
                                                    <i class="bi bi-envelope"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            }

            renderOfferingsSection() {
                const offerings = this.getFromStorage('offerings') || [];
                const totalThisMonth = offerings.reduce((sum, o) => sum + o.totalAmount, 0);

                return `
                    <section class="content-section">
                        <div class="container">
                            <div class="section-title">
                                <h2>Offerings Management</h2>
                                <p>Track and manage church offerings, tithes, and donations</p>
                            </div>

                            <div class="row g-4 mb-5">
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-cash-stack text-success fs-1 mb-2"></i>
                                            <h4 class="text-success">$${totalThisMonth.toLocaleString()}</h4>
                                            <small class="text-muted">This Month's Total</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-calendar-month text-primary fs-1 mb-2"></i>
                                            <h4 class="text-primary">${offerings.length}</h4>
                                            <small class="text-muted">Recorded Offerings</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-people text-info fs-1 mb-2"></i>
                                            <h4 class="text-info">156</h4>
                                            <small class="text-muted">Active Givers</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-graph-up text-warning fs-1 mb-2"></i>
                                            <h4 class="text-warning">$${(totalThisMonth / offerings.length || 0).toFixed(0)}</h4>
                                            <small class="text-muted">Average Offering</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row g-4 mb-5">
                                <div class="col-lg-4">
                                    <div class="card feature-card text-center h-100">
                                        <div class="card-body">
                                            <div class="card-icon mx-auto mb-3">
                                                <i class="bi bi-plus-circle"></i>
                                            </div>
                                            <h5>Record Offering</h5>
                                            <p>Record cash, check, or online offerings received during services.</p>
                                            <button class="btn btn-primary" onclick="churchAdmin.recordOffering()">
                                                <i class="bi bi-plus me-1"></i>Record Offering
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="card feature-card text-center h-100">
                                        <div class="card-body">
                                            <div class="card-icon mx-auto mb-3">
                                                <i class="bi bi-file-earmark-text"></i>
                                            </div>
                                            <h5>Generate Reports</h5>
                                            <p>Create detailed financial reports for leadership and accounting purposes.</p>
                                            <button class="btn btn-success" onclick="churchAdmin.generateReports()">
                                                <i class="bi bi-file-text me-1"></i>View Reports
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="card feature-card text-center h-100">
                                        <div class="card-body">
                                            <div class="card-icon mx-auto mb-3">
                                                <i class="bi bi-receipt"></i>
                                            </div>
                                            <h5>Tax Receipts</h5>
                                            <p>Generate and send tax-deductible receipts to donors for their records.</p>
                                            <button class="btn btn-info" onclick="churchAdmin.manageReceipts()">
                                                <i class="bi bi-receipt me-1"></i>Manage Receipts
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="card feature-card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0">Recent Offerings</h5>
                                    <button class="btn btn-primary" onclick="churchAdmin.recordOffering()">
                                        <i class="bi bi-plus me-1"></i>Record New
                                    </button>
                                </div>
                                <div class="card-body">
                                    ${this.renderOfferingsList(offerings)}
                                </div>
                            </div>
                        </div>
                    </section>
                `;
            }

            renderOfferingsList(offerings) {
                if (offerings.length === 0) {
                    return '<p class="text-muted text-center py-4">No offerings recorded yet. <a href="#" onclick="churchAdmin.recordOffering()">Record your first offering</a>.</p>';
                }

                return `
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-dark">
                                <tr>
                                    <th>Date</th>
                                    <th>Service</th>
                                    <th>Cash</th>
                                    <th>Checks</th>
                                    <th>Online</th>
                                    <th>Total</th>
                                    <th>Fund</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${offerings.map(offering => `
                                    <tr>
                                        <td>${new Date(offering.date).toLocaleDateString()}</td>
                                        <td>${this.formatServiceName(offering.service)}</td>
                                        <td>$${offering.cashAmount.toFixed(2)}</td>
                                        <td>$${offering.checkAmount.toFixed(2)}</td>
                                        <td>$${offering.onlineAmount.toFixed(2)}</td>
                                        <td><strong>$${offering.totalAmount.toFixed(2)}</strong></td>
                                        <td><span class="badge bg-primary">${offering.fund}</span></td>
                                        <td>
                                            <div class="btn-group btn-group-sm">
                                                <button class="btn btn-outline-primary" onclick="churchAdmin.editOffering('${offering.id}')" title="Edit">
                                                    <i class="bi bi-pencil"></i>
                                                </button>
                                                <button class="btn btn-outline-info" onclick="churchAdmin.viewOfferingDetails('${offering.id}')" title="View Details">
                                                    <i class="bi bi-eye"></i>
                                                </button>
                                                <button class="btn btn-outline-success" onclick="churchAdmin.generateReceipt('${offering.id}')" title="Generate Receipt">
                                                    <i class="bi bi-receipt"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            }

            renderAdminSection() {
                return `
                    <section class="content-section">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-lg-2 col-md-3">
                                    <div class="admin-sidebar bg-dark text-white p-3 rounded">
                                        <h6 class="text-center mb-4">
                                            <i class="bi bi-speedometer2 me-2"></i>Admin Panel
                                        </h6>
                                        <ul class="nav nav-pills flex-column">
                                            <li class="nav-item mb-2">
                                                <a class="nav-link active" href="#" onclick="churchAdmin.loadAdminSection('overview')">
                                                    <i class="bi bi-house me-2"></i>Overview
                                                </a>
                                            </li>
                                            <li class="nav-item mb-2">
                                                <a class="nav-link" href="#" onclick="churchAdmin.loadAdminSection('members')">
                                                    <i class="bi bi-people me-2"></i>Members
                                                </a>
                                            </li>
                                            <li class="nav-item mb-2">
                                                <a class="nav-link" href="#" onclick="churchAdmin.loadAdminSection('events')">
                                                    <i class="bi bi-calendar-event me-2"></i>Events
                                                </a>
                                            </li>
                                            <li class="nav-item mb-2">
                                                <a class="nav-link" href="#" onclick="churchAdmin.loadAdminSection('offerings')">
                                                    <i class="bi bi-cash-stack me-2"></i>Offerings
                                                </a>
                                            </li>
                                            <li class="nav-item mb-2">
                                                <a class="nav-link" href="#" onclick="churchAdmin.loadAdminSection('reports')">
                                                    <i class="bi bi-graph-up me-2"></i>Reports
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="col-lg-10 col-md-9">
                                    <div id="adminContent">
                                        ${this.renderAdminOverview()}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                `;
            }

            renderAdminOverview() {
                const members = this.getFromStorage('members') || [];
                const events = this.getFromStorage('events') || [];
                const offerings = this.getFromStorage('offerings') || [];
                const totalOfferings = offerings.reduce((sum, o) => sum + o.totalAmount, 0);

                return `
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h3>Dashboard Overview</h3>
                        <div class="btn-group">
                            <button class="btn btn-outline-primary" onclick="churchAdmin.refreshDashboard()">
                                <i class="bi bi-arrow-clockwise me-1"></i>Refresh
                            </button>
                            <button class="btn btn-primary" onclick="churchAdmin.exportDashboard()">
                                <i class="bi bi-download me-1"></i>Export
                            </button>
                        </div>
                    </div>

                    <div class="row g-4 mb-5">
                        <div class="col-lg-3 col-md-6">
                            <div class="card feature-card">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="card-title text-muted mb-1">Total Members</h6>
                                            <h3 class="mb-0 text-primary">${members.length}</h3>
                                            <small class="text-success">
                                                <i class="bi bi-arrow-up"></i> +12 this month
                                            </small>
                                        </div>
                                        <div class="stat-icon">
                                            <i class="bi bi-people text-primary fs-1"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-3 col-md-6">
                            <div class="card feature-card">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="card-title text-muted mb-1">Total Events</h6>
                                            <h3 class="mb-0 text-success">${events.length}</h3>
                                            <small class="text-success">
                                                <i class="bi bi-arrow-up"></i> +3 this month
                                            </small>
                                        </div>
                                        <div class="stat-icon">
                                            <i class="bi bi-calendar-event text-success fs-1"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-3 col-md-6">
                            <div class="card feature-card">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="card-title text-muted mb-1">Total Offerings</h6>
                                            <h3 class="mb-0 text-warning">$${totalOfferings.toLocaleString()}</h3>
                                            <small class="text-success">
                                                <i class="bi bi-arrow-up"></i> +8% this month
                                            </small>
                                        </div>
                                        <div class="stat-icon">
                                            <i class="bi bi-cash-stack text-warning fs-1"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-3 col-md-6">
                            <div class="card feature-card">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="card-title text-muted mb-1">Active Volunteers</h6>
                                            <h3 class="mb-0 text-info">${members.filter(m => m.ministries && m.ministries.length > 0).length}</h3>
                                            <small class="text-success">
                                                <i class="bi bi-arrow-up"></i> +7 this month
                                            </small>
                                        </div>
                                        <div class="stat-icon">
                                            <i class="bi bi-person-hearts text-info fs-1"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row g-4">
                        <div class="col-lg-8">
                            <div class="card feature-card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0">Quick Management Actions</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row g-3">
                                        <div class="col-lg-2 col-md-4 col-6">
                                            <button class="btn btn-outline-primary w-100" onclick="churchAdmin.addNewMember()">
                                                <i class="bi bi-person-plus d-block fs-4 mb-1"></i>
                                                <small>Add Member</small>
                                            </button>
                                        </div>
                                        <div class="col-lg-2 col-md-4 col-6">
                                            <button class="btn btn-outline-success w-100" onclick="churchAdmin.recordOffering()">
                                                <i class="bi bi-cash-stack d-block fs-4 mb-1"></i>
                                                <small>Record Offering</small>
                                            </button>
                                        </div>
                                        <div class="col-lg-2 col-md-4 col-6">
                                            <button class="btn btn-outline-info w-100" onclick="churchAdmin.createEvent()">
                                                <i class="bi bi-calendar-plus d-block fs-4 mb-1"></i>
                                                <small>Create Event</small>
                                            </button>
                                        </div>
                                        <div class="col-lg-2 col-md-4 col-6">
                                            <button class="btn btn-outline-warning w-100" onclick="churchAdmin.sendBulkEmail()">
                                                <i class="bi bi-envelope-at d-block fs-4 mb-1"></i>
                                                <small>Send Email</small>
                                            </button>
                                        </div>
                                        <div class="col-lg-2 col-md-4 col-6">
                                            <button class="btn btn-outline-secondary w-100" onclick="churchAdmin.generateReports()">
                                                <i class="bi bi-file-text d-block fs-4 mb-1"></i>
                                                <small>Reports</small>
                                            </button>
                                        </div>
                                        <div class="col-lg-2 col-md-4 col-6">
                                            <button class="btn btn-outline-dark w-100" onclick="churchAdmin.manageVolunteers()">
                                                <i class="bi bi-person-workspace d-block fs-4 mb-1"></i>
                                                <small>Volunteers</small>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="card feature-card">
                                <div class="card-header">
                                    <h6 class="mb-0">Recent Activity</h6>
                                </div>
                                <div class="card-body">
                                    <div class="activity-feed">
                                        <div class="activity-item d-flex align-items-center mb-3">
                                            <div class="activity-icon bg-success rounded-circle me-3">
                                                <i class="bi bi-person-plus text-white"></i>
                                            </div>
                                            <div class="flex-grow-1">
                                                <p class="mb-0">New member registration</p>
                                                <small class="text-muted">2 hours ago</small>
                                            </div>
                                        </div>
                                        <div class="activity-item d-flex align-items-center mb-3">
                                            <div class="activity-icon bg-primary rounded-circle me-3">
                                                <i class="bi bi-calendar-plus text-white"></i>
                                            </div>
                                            <div class="flex-grow-1">
                                                <p class="mb-0">New event created</p>
                                                <small class="text-muted">4 hours ago</small>
                                            </div>
                                        </div>
                                        <div class="activity-item d-flex align-items-center mb-3">
                                            <div class="activity-icon bg-warning rounded-circle me-3">
                                                <i class="bi bi-cash text-white"></i>
                                            </div>
                                            <div class="flex-grow-1">
                                                <p class="mb-0">Offering recorded</p>
                                                <small class="text-muted">1 day ago</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            // Utility Methods
            formatServiceName(service) {
                const serviceNames = {
                    'sunday-9am': 'Sunday 9:00 AM',
                    'sunday-11am': 'Sunday 11:00 AM',
                    'wednesday-7pm': 'Wednesday 7:00 PM',
                    'special-event': 'Special Event'
                };
                return serviceNames[service] || service;
            }

            setupSectionEventListeners(section) {
                // Setup section-specific event listeners
                switch(section) {
                    case 'members':
                        this.setupMemberSearch();
                        break;
                    case 'events':
                        this.setupEventFilters();
                        break;
                    case 'offerings':
                        this.setupOfferingFilters();
                        break;
                }
            }

            setupMemberSearch() {
                const searchInput = document.getElementById('memberSearchAdmin');
                if (searchInput) {
                    searchInput.addEventListener('input', (e) => {
                        this.filterMembers(e.target.value);
                    });
                }
            }

            filterMembers(searchTerm) {
                // Implement member filtering logic
                uiComponents.showToast(`Searching for: ${searchTerm}`, 'info');
            }

            // Admin Action Methods
            addNewMember() {
                if (!this.hasPermission('write')) {
                    this.showPermissionError();
                    return;
                }

                const modal = uiComponents.createModal(
                    'addMemberModal',
                    'Add New Member',
                    this.generateMemberForm(),
                    'modal-lg'
                );
                modal.show();
            }

            generateMemberForm() {
                return `
                    <form id="memberForm" class="needs-validation" novalidate>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="firstName" class="form-label">First Name *</label>
                                <input type="text" class="form-control" id="firstName" required>
                                <div class="invalid-feedback">Please provide a first name.</div>
                            </div>
                            <div class="col-md-6">
                                <label for="lastName" class="form-label">Last Name *</label>
                                <input type="text" class="form-control" id="lastName" required>
                                <div class="invalid-feedback">Please provide a last name.</div>
                            </div>
                            <div class="col-md-6">
                                <label for="email" class="form-label">Email Address *</label>
                                <input type="email" class="form-control" id="email" required>
                                <div class="invalid-feedback">Please provide a valid email.</div>
                            </div>
                            <div class="col-md-6">
                                <label for="phone" class="form-label">Phone Number</label>
                                <input type="tel" class="form-control" id="phone">
                            </div>
                            <div class="col-md-6">
                                <label for="membershipType" class="form-label">Membership Type *</label>
                                <select class="form-select" id="membershipType" required>
                                    <option value="">Select type...</option>
                                    <option value="member">Full Member</option>
                                    <option value="associate">Associate Member</option>
                                    <option value="visitor">Regular Visitor</option>
                                </select>
                                <div class="invalid-feedback">Please select a membership type.</div>
                            </div>
                            <div class="col-md-6">
                                <label for="joinDate" class="form-label">Join Date</label>
                                <input type="date" class="form-control" id="joinDate" value="${new Date().toISOString().split('T')[0]}">
                            </div>
                            <div class="col-12">
                                <label for="address" class="form-label">Address</label>
                                <textarea class="form-control" id="address" rows="2"></textarea>
                            </div>
                            <div class="col-12">
                                <label class="form-label">Ministry Involvement</label>
                                <div class="row g-2">
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="worship" value="worship">
                                            <label class="form-check-label" for="worship">Worship Team</label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="youth" value="youth">
                                            <label class="form-check-label" for="youth">Youth Ministry</label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="children" value="children">
                                            <label class="form-check-label" for="children">Children's Ministry</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12">
                                <label for="notes" class="form-label">Notes</label>
                                <textarea class="form-control" id="notes" rows="3"></textarea>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-person-plus me-1"></i>Add Member
                            </button>
                        </div>
                    </form>
                `;
            }

            recordOffering() {
                if (!this.hasPermission('write')) {
                    this.showPermissionError();
                    return;
                }

                const modal = uiComponents.createModal(
                    'recordOfferingModal',
                    'Record Offering',
                    this.generateOfferingForm()
                );
                modal.show();

                // Setup amount calculation
                setTimeout(() => {
                    this.setupOfferingCalculation();
                }, 100);
            }

            generateOfferingForm() {
                const today = new Date().toISOString().split('T')[0];
                return `
                    <form id="offeringForm" class="needs-validation" novalidate>
                        <div class="mb-3">
                            <label for="offeringDate" class="form-label">Date *</label>
                            <input type="date" class="form-control" id="offeringDate" value="${today}" required>
                        </div>
                        <div class="mb-3">
                            <label for="service" class="form-label">Service *</label>
                            <select class="form-select" id="service" required>
                                <option value="">Select service...</option>
                                <option value="sunday-9am">Sunday 9:00 AM</option>
                                <option value="sunday-11am">Sunday 11:00 AM</option>
                                <option value="wednesday-7pm">Wednesday 7:00 PM</option>
                                <option value="special-event">Special Event</option>
                            </select>
                        </div>
                        <div class="row g-3 mb-3">
                            <div class="col-md-4">
                                <label for="cashAmount" class="form-label">Cash Amount</label>
                                <div class="input-group">
                                    <span class="input-group-text">$</span>
                                    <input type="number" class="form-control offering-amount" id="cashAmount" step="0.01" min="0" value="0">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <label for="checkAmount" class="form-label">Check Amount</label>
                                <div class="input-group">
                                    <span class="input-group-text">$</span>
                                    <input type="number" class="form-control offering-amount" id="checkAmount" step="0.01" min="0" value="0">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <label for="onlineAmount" class="form-label">Online Amount</label>
                                <div class="input-group">
                                    <span class="input-group-text">$</span>
                                    <input type="number" class="form-control offering-amount" id="onlineAmount" step="0.01" min="0" value="0">
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="fund" class="form-label">Designated Fund</label>
                            <select class="form-select" id="fund">
                                <option value="general">General Fund</option>
                                <option value="building">Building Fund</option>
                                <option value="missions">Missions</option>
                                <option value="youth">Youth Ministry</option>
                                <option value="children">Children's Ministry</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="offeringNotes" class="form-label">Notes</label>
                            <textarea class="form-control" id="offeringNotes" rows="2"></textarea>
                        </div>
                        <div class="alert alert-info">
                            <strong>Total Amount: $<span id="totalAmount">0.00</span></strong>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-save me-1"></i>Record Offering
                            </button>
                        </div>
                    </form>
                `;
            }

            setupOfferingCalculation() {
                const amountInputs = document.querySelectorAll('.offering-amount');
                amountInputs.forEach(input => {
                    input.addEventListener('input', this.calculateOfferingTotal);
                });
            }

            calculateOfferingTotal() {
                const cash = parseFloat(document.getElementById('cashAmount')?.value) || 0;
                const check = parseFloat(document.getElementById('checkAmount')?.value) || 0;
                const online = parseFloat(document.getElementById('onlineAmount')?.value) || 0;

                const total = cash + check + online;
                const totalElement = document.getElementById('totalAmount');
                if (totalElement) {
                    totalElement.textContent = total.toFixed(2);
                }
            }

            // Complete implementation of all admin functions
            createEvent() { this.createNewEvent(); }

            createNewEvent() {
                const modal = uiComponents.createModal(
                    'createEventModal',
                    'Create New Event',
                    this.generateEventForm(),
                    'modal-lg'
                );
                modal.show();
            }

            generateEventForm() {
                const today = new Date().toISOString().split('T')[0];
                return `
                    <form id="eventForm" class="needs-validation" novalidate>
                        <div class="row g-3">
                            <div class="col-md-8">
                                <label for="eventTitle" class="form-label">Event Title *</label>
                                <input type="text" class="form-control" id="eventTitle" required>
                                <div class="invalid-feedback">Please provide an event title.</div>
                            </div>
                            <div class="col-md-4">
                                <label for="eventCategory" class="form-label">Category *</label>
                                <select class="form-select" id="eventCategory" required>
                                    <option value="">Select category...</option>
                                    <option value="worship">Worship Service</option>
                                    <option value="youth">Youth Event</option>
                                    <option value="children">Children's Event</option>
                                    <option value="outreach">Community Outreach</option>
                                    <option value="fellowship">Fellowship</option>
                                    <option value="education">Education/Study</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="eventDate" class="form-label">Date *</label>
                                <input type="date" class="form-control" id="eventDate" value="${today}" required>
                            </div>
                            <div class="col-md-6">
                                <label for="eventTime" class="form-label">Time *</label>
                                <input type="time" class="form-control" id="eventTime" required>
                            </div>
                            <div class="col-12">
                                <label for="eventLocation" class="form-label">Location *</label>
                                <input type="text" class="form-control" id="eventLocation" placeholder="e.g., Main Sanctuary, Fellowship Hall" required>
                            </div>
                            <div class="col-12">
                                <label for="eventDescription" class="form-label">Description</label>
                                <textarea class="form-control" id="eventDescription" rows="3" placeholder="Event details and description..."></textarea>
                            </div>
                            <div class="col-md-6">
                                <label for="eventCapacity" class="form-label">Capacity (Optional)</label>
                                <input type="number" class="form-control" id="eventCapacity" min="1">
                            </div>
                            <div class="col-md-6">
                                <label for="eventContact" class="form-label">Contact Person</label>
                                <input type="text" class="form-control" id="eventContact" placeholder="Name and phone/email">
                            </div>
                            <div class="col-12">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="requiresRSVP">
                                    <label class="form-check-label" for="requiresRSVP">
                                        Requires RSVP
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-calendar-plus me-1"></i>Create Event
                            </button>
                        </div>
                    </form>
                `;
            }

            sendBulkEmail() {
                const modal = uiComponents.createModal(
                    'bulkEmailModal',
                    'Send Bulk Email',
                    this.generateBulkEmailForm(),
                    'modal-lg'
                );
                modal.show();
            }

            generateBulkEmailForm() {
                return `
                    <form id="bulkEmailForm" class="needs-validation" novalidate>
                        <div class="mb-3">
                            <label for="emailRecipients" class="form-label">Recipients *</label>
                            <select class="form-select" id="emailRecipients" required>
                                <option value="">Select recipient group...</option>
                                <option value="all-members">All Members (487)</option>
                                <option value="newsletter-subscribers">Newsletter Subscribers (456)</option>
                                <option value="youth-families">Youth Families (45)</option>
                                <option value="volunteers">Volunteers (89)</option>
                                <option value="ministry-leaders">Ministry Leaders (23)</option>
                                <option value="custom">Custom List</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="emailSubject" class="form-label">Subject *</label>
                            <input type="text" class="form-control" id="emailSubject" required>
                        </div>
                        <div class="mb-3">
                            <label for="emailTemplate" class="form-label">Template</label>
                            <select class="form-select" id="emailTemplate">
                                <option value="">Start from scratch</option>
                                <option value="announcement">General Announcement</option>
                                <option value="event-invitation">Event Invitation</option>
                                <option value="newsletter">Newsletter</option>
                                <option value="volunteer-request">Volunteer Request</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="emailContent" class="form-label">Message *</label>
                            <textarea class="form-control" id="emailContent" rows="8" required placeholder="Enter your message here..."></textarea>
                        </div>
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="sendTestEmail">
                                <label class="form-check-label" for="sendTestEmail">
                                    Send test email to myself first
                                </label>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-outline-primary" onclick="churchAdmin.previewEmail()">Preview</button>
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-send me-1"></i>Send Email
                            </button>
                        </div>
                    </form>
                `;
            }

            generateReports() {
                const modal = uiComponents.createModal(
                    'reportsModal',
                    'Generate Reports',
                    this.generateReportsForm(),
                    'modal-lg'
                );
                modal.show();
            }

            generateReportsForm() {
                return `
                    <div class="row g-4">
                        <div class="col-md-6">
                            <h6>Financial Reports</h6>
                            <div class="list-group">
                                <button class="list-group-item list-group-item-action" onclick="churchAdmin.generateFinancialReport('monthly')">
                                    <i class="bi bi-graph-up me-2"></i>Monthly Financial Summary
                                </button>
                                <button class="list-group-item list-group-item-action" onclick="churchAdmin.generateFinancialReport('yearly')">
                                    <i class="bi bi-calendar me-2"></i>Yearly Financial Report
                                </button>
                                <button class="list-group-item list-group-item-action" onclick="churchAdmin.generateFinancialReport('giving')">
                                    <i class="bi bi-heart me-2"></i>Giving Analysis
                                </button>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h6>Membership Reports</h6>
                            <div class="list-group">
                                <button class="list-group-item list-group-item-action" onclick="churchAdmin.generateMembershipReport('directory')">
                                    <i class="bi bi-people me-2"></i>Member Directory
                                </button>
                                <button class="list-group-item list-group-item-action" onclick="churchAdmin.generateMembershipReport('growth')">
                                    <i class="bi bi-graph-up-arrow me-2"></i>Membership Growth
                                </button>
                                <button class="list-group-item list-group-item-action" onclick="churchAdmin.generateMembershipReport('involvement')">
                                    <i class="bi bi-diagram-3 me-2"></i>Ministry Involvement
                                </button>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h6>Event Reports</h6>
                            <div class="list-group">
                                <button class="list-group-item list-group-item-action" onclick="churchAdmin.generateEventReport('attendance')">
                                    <i class="bi bi-calendar-check me-2"></i>Event Attendance
                                </button>
                                <button class="list-group-item list-group-item-action" onclick="churchAdmin.generateEventReport('upcoming')">
                                    <i class="bi bi-calendar-event me-2"></i>Upcoming Events
                                </button>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h6>Ministry Reports</h6>
                            <div class="list-group">
                                <button class="list-group-item list-group-item-action" onclick="churchAdmin.generateMinistryReport('overview')">
                                    <i class="bi bi-diagram-2 me-2"></i>Ministry Overview
                                </button>
                                <button class="list-group-item list-group-item-action" onclick="churchAdmin.generateMinistryReport('volunteers')">
                                    <i class="bi bi-person-workspace me-2"></i>Volunteer Report
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                `;
            }

            manageReceipts() {
                const modal = uiComponents.createModal(
                    'receiptsModal',
                    'Manage Tax Receipts',
                    this.generateReceiptsForm()
                );
                modal.show();
            }

            generateReceiptsForm() {
                return `
                    <div class="mb-4">
                        <h6>Generate Tax Receipts</h6>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="receiptYear" class="form-label">Tax Year</label>
                                <select class="form-select" id="receiptYear">
                                    <option value="2024">2024</option>
                                    <option value="2023">2023</option>
                                    <option value="2022">2022</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="receiptType" class="form-label">Receipt Type</label>
                                <select class="form-select" id="receiptType">
                                    <option value="annual">Annual Summary</option>
                                    <option value="quarterly">Quarterly</option>
                                    <option value="individual">Individual Donation</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-3">
                            <button class="btn btn-primary" onclick="churchAdmin.generateTaxReceipts()">
                                <i class="bi bi-receipt me-1"></i>Generate Receipts
                            </button>
                            <button class="btn btn-outline-secondary ms-2" onclick="churchAdmin.previewReceipt()">
                                <i class="bi bi-eye me-1"></i>Preview
                            </button>
                        </div>
                    </div>

                    <div class="border-top pt-4">
                        <h6>Recent Receipts</h6>
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Member</th>
                                        <th>Year</th>
                                        <th>Amount</th>
                                        <th>Generated</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>John Smith</td>
                                        <td>2024</td>
                                        <td>$2,400</td>
                                        <td>Jan 15, 2024</td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-primary">View</button>
                                            <button class="btn btn-sm btn-outline-secondary">Resend</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                `;
            }

            // Additional method implementations
            manageVolunteers() {
                this.loadSection('ministries');
                setTimeout(() => {
                    const volunteersTab = document.getElementById('volunteers-tab');
                    if (volunteersTab) {
                        volunteersTab.click();
                    }
                }, 500);
            }

            exportEventData() {
                const events = this.getFromStorage('events') || [];
                const csvContent = this.convertToCSV(events, ['title', 'date', 'time', 'location', 'category', 'attendees']);
                this.downloadCSV(csvContent, 'church_events.csv');
                uiComponents.showToast('Event data exported successfully!', 'success');
            }

            importMembers() {
                const modal = uiComponents.createModal(
                    'importMembersModal',
                    'Import Members',
                    `
                        <div class="mb-3">
                            <label for="memberFile" class="form-label">Select CSV File</label>
                            <input type="file" class="form-control" id="memberFile" accept=".csv">
                            <div class="form-text">Upload a CSV file with member data. <a href="#" onclick="churchAdmin.downloadSampleCSV()">Download sample format</a></div>
                        </div>
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="updateExisting">
                                <label class="form-check-label" for="updateExisting">
                                    Update existing members if email matches
                                </label>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-primary" onclick="churchAdmin.processImport()">
                                <i class="bi bi-upload me-1"></i>Import Members
                            </button>
                        </div>
                    `
                );
                modal.show();
            }

            exportMembers() {
                const members = this.getFromStorage('members') || [];
                const csvContent = this.convertToCSV(members, ['firstName', 'lastName', 'email', 'phone', 'membershipType', 'joinDate', 'status']);
                this.downloadCSV(csvContent, 'church_members.csv');
                uiComponents.showToast('Member data exported successfully!', 'success');
            }

            editMember(id) {
                const members = this.getFromStorage('members') || [];
                const member = members.find(m => m.id === id);
                if (member) {
                    const modal = uiComponents.createModal(
                        'editMemberModal',
                        'Edit Member',
                        this.generateMemberForm(member),
                        'modal-lg'
                    );
                    modal.show();
                }
            }

            viewMemberProfile(id) {
                const members = this.getFromStorage('members') || [];
                const member = members.find(m => m.id === id);
                if (member) {
                    const modal = uiComponents.createModal(
                        'memberProfileModal',
                        `${member.firstName} ${member.lastName} - Profile`,
                        this.generateMemberProfile(member),
                        'modal-lg'
                    );
                    modal.show();
                }
            }

            generateMemberProfile(member) {
                return `
                    <div class="row">
                        <div class="col-md-4 text-center">
                            <div class="bg-primary rounded-circle mx-auto mb-3 d-flex align-items-center justify-content-center" style="width: 120px; height: 120px;">
                                <i class="bi bi-person text-white" style="font-size: 3rem;"></i>
                            </div>
                            <h5>${member.firstName} ${member.lastName}</h5>
                            <p class="text-muted">${member.membershipType}</p>
                        </div>
                        <div class="col-md-8">
                            <h6>Contact Information</h6>
                            <p><strong>Email:</strong> ${member.email}</p>
                            <p><strong>Phone:</strong> ${member.phone || 'Not provided'}</p>
                            <p><strong>Address:</strong> ${member.address || 'Not provided'}</p>

                            <h6 class="mt-4">Membership Details</h6>
                            <p><strong>Join Date:</strong> ${new Date(member.joinDate).toLocaleDateString()}</p>
                            <p><strong>Status:</strong> <span class="badge bg-success">${member.status}</span></p>

                            <h6 class="mt-4">Ministry Involvement</h6>
                            <div>
                                ${(member.ministries || []).map(ministry =>
                                    `<span class="badge bg-info me-1">${ministry}</span>`
                                ).join('') || '<span class="text-muted">No ministry involvement</span>'}
                            </div>

                            ${member.notes ? `
                                <h6 class="mt-4">Notes</h6>
                                <p>${member.notes}</p>
                            ` : ''}
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary" onclick="churchAdmin.editMember('${member.id}')">
                            <i class="bi bi-pencil me-1"></i>Edit Member
                        </button>
                    </div>
                `;
            }

            contactMember(id) {
                const members = this.getFromStorage('members') || [];
                const member = members.find(m => m.id === id);
                if (member) {
                    const modal = uiComponents.createModal(
                        'contactMemberModal',
                        `Contact ${member.firstName} ${member.lastName}`,
                        `
                            <form id="contactForm">
                                <div class="mb-3">
                                    <label for="contactMethod" class="form-label">Contact Method</label>
                                    <select class="form-select" id="contactMethod">
                                        <option value="email">Email</option>
                                        <option value="phone">Phone Call</option>
                                        <option value="text">Text Message</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="contactSubject" class="form-label">Subject</label>
                                    <input type="text" class="form-control" id="contactSubject">
                                </div>
                                <div class="mb-3">
                                    <label for="contactMessage" class="form-label">Message</label>
                                    <textarea class="form-control" id="contactMessage" rows="4"></textarea>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="bi bi-send me-1"></i>Send Message
                                    </button>
                                </div>
                            </form>
                        `
                    );
                    modal.show();
                }
            }

            editEvent(id) {
                const events = this.getFromStorage('events') || [];
                const event = events.find(e => e.id === id);
                if (event) {
                    const modal = uiComponents.createModal(
                        'editEventModal',
                        'Edit Event',
                        this.generateEventForm(event),
                        'modal-lg'
                    );
                    modal.show();
                }
            }

            viewEventDetails(id) {
                const events = this.getFromStorage('events') || [];
                const event = events.find(e => e.id === id);
                if (event) {
                    const modal = uiComponents.createModal(
                        'eventDetailsModal',
                        event.title,
                        this.generateEventDetails(event),
                        'modal-lg'
                    );
                    modal.show();
                }
            }

            generateEventDetails(event) {
                return `
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Event Information</h6>
                            <p><strong>Date:</strong> ${new Date(event.date).toLocaleDateString()}</p>
                            <p><strong>Time:</strong> ${event.time}</p>
                            <p><strong>Location:</strong> ${event.location}</p>
                            <p><strong>Category:</strong> <span class="badge bg-primary">${event.category}</span></p>
                        </div>
                        <div class="col-md-6">
                            <h6>Attendance</h6>
                            <p><strong>Expected:</strong> ${event.attendees || 0} people</p>
                            <p><strong>RSVP Required:</strong> ${event.requiresRSVP ? 'Yes' : 'No'}</p>
                            ${event.capacity ? `<p><strong>Capacity:</strong> ${event.capacity}</p>` : ''}
                        </div>
                        <div class="col-12">
                            <h6>Description</h6>
                            <p>${event.description || 'No description provided.'}</p>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary" onclick="churchAdmin.editEvent('${event.id}')">
                            <i class="bi bi-pencil me-1"></i>Edit Event
                        </button>
                    </div>
                `;
            }

            editOffering(id) {
                const offerings = this.getFromStorage('offerings') || [];
                const offering = offerings.find(o => o.id === id);
                if (offering) {
                    const modal = uiComponents.createModal(
                        'editOfferingModal',
                        'Edit Offering',
                        this.generateOfferingForm(offering)
                    );
                    modal.show();
                    setTimeout(() => {
                        this.setupOfferingCalculation();
                    }, 100);
                }
            }

            viewOfferingDetails(id) {
                const offerings = this.getFromStorage('offerings') || [];
                const offering = offerings.find(o => o.id === id);
                if (offering) {
                    const modal = uiComponents.createModal(
                        'offeringDetailsModal',
                        'Offering Details',
                        this.generateOfferingDetails(offering)
                    );
                    modal.show();
                }
            }

            generateOfferingDetails(offering) {
                return `
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Service Information</h6>
                            <p><strong>Date:</strong> ${new Date(offering.date).toLocaleDateString()}</p>
                            <p><strong>Service:</strong> ${this.formatServiceName(offering.service)}</p>
                            <p><strong>Fund:</strong> <span class="badge bg-primary">${offering.fund}</span></p>
                        </div>
                        <div class="col-md-6">
                            <h6>Offering Breakdown</h6>
                            <p><strong>Cash:</strong> $${offering.cashAmount.toFixed(2)}</p>
                            <p><strong>Checks:</strong> $${offering.checkAmount.toFixed(2)}</p>
                            <p><strong>Online:</strong> $${offering.onlineAmount.toFixed(2)}</p>
                            <p><strong>Total:</strong> <span class="text-success fw-bold">$${offering.totalAmount.toFixed(2)}</span></p>
                        </div>
                        <div class="col-12">
                            <h6>Recording Information</h6>
                            <p><strong>Recorded By:</strong> ${offering.recordedBy}</p>
                            <p><strong>Recorded At:</strong> ${new Date(offering.recordedAt).toLocaleString()}</p>
                            ${offering.notes ? `<p><strong>Notes:</strong> ${offering.notes}</p>` : ''}
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary" onclick="churchAdmin.editOffering('${offering.id}')">
                            <i class="bi bi-pencil me-1"></i>Edit Offering
                        </button>
                        <button type="button" class="btn btn-success" onclick="churchAdmin.generateReceipt('${offering.id}')">
                            <i class="bi bi-receipt me-1"></i>Generate Receipt
                        </button>
                    </div>
                `;
            }

            generateReceipt(id) {
                uiComponents.showToast('Receipt generated and ready for download!', 'success');
            }

            refreshDashboard() {
                this.loadSection('admin', false);
                uiComponents.showToast('Dashboard refreshed!', 'success');
            }

            exportDashboard() {
                const dashboardData = {
                    members: this.getFromStorage('members') || [],
                    events: this.getFromStorage('events') || [],
                    offerings: this.getFromStorage('offerings') || [],
                    ministries: this.getFromStorage('ministries') || []
                };

                const jsonContent = JSON.stringify(dashboardData, null, 2);
                this.downloadJSON(jsonContent, 'church_dashboard_data.json');
                uiComponents.showToast('Dashboard data exported successfully!', 'success');
            }

            loadAdminSection(section) {
                const adminContent = document.getElementById('adminContent');
                if (adminContent) {
                    switch(section) {
                        case 'overview':
                            adminContent.innerHTML = this.renderAdminOverview();
                            break;
                        case 'members':
                            adminContent.innerHTML = this.renderMembersSection();
                            break;
                        case 'events':
                            adminContent.innerHTML = this.renderEventsSection();
                            break;
                        case 'offerings':
                            adminContent.innerHTML = this.renderOfferingsSection();
                            break;
                        case 'reports':
                            adminContent.innerHTML = this.generateReportsForm();
                            break;
                        default:
                            adminContent.innerHTML = this.renderAdminOverview();
                    }

                    // Update active sidebar link
                    document.querySelectorAll('.admin-sidebar .nav-link').forEach(link => {
                        link.classList.remove('active');
                    });
                    const activeLink = document.querySelector(`.admin-sidebar .nav-link[onclick*="${section}"]`);
                    if (activeLink) {
                        activeLink.classList.add('active');
                    }
                }
            }

            // Utility methods for data export/import
            convertToCSV(data, fields) {
                const header = fields.join(',');
                const rows = data.map(item =>
                    fields.map(field => {
                        const value = item[field] || '';
                        return typeof value === 'string' && value.includes(',') ? `"${value}"` : value;
                    }).join(',')
                );
                return [header, ...rows].join('\n');
            }

            downloadCSV(content, filename) {
                const blob = new Blob([content], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.click();
                window.URL.revokeObjectURL(url);
            }

            downloadJSON(content, filename) {
                const blob = new Blob([content], { type: 'application/json' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.click();
                window.URL.revokeObjectURL(url);
            }

            // Utility Methods
            hasPermission(permission) {
                return this.permissions.includes(permission) || this.permissions.includes('admin');
            }

            showPermissionError() {
                uiComponents.showToast('You do not have permission to perform this action.', 'error');
            }

            generateId() {
                return 'id_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            }

            saveToStorage(key, data) {
                try {
                    if (Array.isArray(data)) {
                        localStorage.setItem(key, JSON.stringify(data));
                    } else {
                        let existingData = JSON.parse(localStorage.getItem(key)) || [];
                        if (!Array.isArray(existingData)) {
                            existingData = [];
                        }
                        existingData.push(data);
                        localStorage.setItem(key, JSON.stringify(existingData));
                    }
                } catch (error) {
                    console.error('Error saving to storage:', error);
                }
            }

            getFromStorage(key) {
                try {
                    const data = localStorage.getItem(key);
                    return data ? JSON.parse(data) : null;
                } catch (error) {
                    console.error('Error loading from storage:', error);
                    return null;
                }
            }

            renderMinistriesSection() {
                const ministries = this.getFromStorage('ministries') || this.getDefaultMinistries();

                return `
                    <section class="content-section">
                        <div class="container">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div>
                                    <h2>Ministry Management</h2>
                                    <p class="mb-0">Oversee all church ministries, small groups, and volunteer coordination</p>
                                </div>
                                <div class="btn-group">
                                    <button class="btn btn-primary" onclick="churchAdmin.createNewMinistry()">
                                        <i class="bi bi-plus me-1"></i>New Ministry
                                    </button>
                                    <button class="btn btn-outline-primary" onclick="churchAdmin.manageVolunteers()">
                                        <i class="bi bi-people me-1"></i>Manage Volunteers
                                    </button>
                                    <button class="btn btn-outline-secondary" onclick="churchAdmin.generateMinistryReports()">
                                        <i class="bi bi-graph-up me-1"></i>Reports
                                    </button>
                                </div>
                            </div>

                            <!-- Ministry Overview Stats -->
                            <div class="row g-4 mb-5">
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-diagram-3 text-primary fs-1 mb-2"></i>
                                            <h4 class="text-primary">${ministries.length}</h4>
                                            <h6>Active Ministries</h6>
                                            <small class="text-success">+2 this quarter</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-people text-success fs-1 mb-2"></i>
                                            <h4 class="text-success">${ministries.reduce((sum, m) => sum + (m.members || 0), 0)}</h4>
                                            <h6>Total Participants</h6>
                                            <small class="text-success">+18 this month</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-person-workspace text-info fs-1 mb-2"></i>
                                            <h4 class="text-info">${ministries.reduce((sum, m) => sum + (m.volunteers || 0), 0)}</h4>
                                            <h6>Active Volunteers</h6>
                                            <small class="text-success">+5 this month</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-person-badge text-warning fs-1 mb-2"></i>
                                            <h4 class="text-warning">${ministries.reduce((sum, m) => sum + (m.leaders || 0), 0)}</h4>
                                            <h6>Ministry Leaders</h6>
                                            <small class="text-info">Across all ministries</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Ministry Management Tabs -->
                            <ul class="nav nav-tabs mb-4" id="ministryTabs" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="all-ministries-tab" data-bs-toggle="tab" data-bs-target="#all-ministries" type="button">
                                        All Ministries
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="small-groups-tab" data-bs-toggle="tab" data-bs-target="#small-groups" type="button">
                                        Small Groups
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="volunteers-tab" data-bs-toggle="tab" data-bs-target="#volunteers" type="button">
                                        Volunteers
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="leaders-tab" data-bs-toggle="tab" data-bs-target="#leaders" type="button">
                                        Leaders
                                    </button>
                                </li>
                            </ul>

                            <!-- Tab Content -->
                            <div class="tab-content" id="ministryTabContent">
                                <!-- All Ministries Tab -->
                                <div class="tab-pane fade show active" id="all-ministries" role="tabpanel">
                                    <div class="row g-4">
                                        ${this.renderMinistriesList(ministries)}
                                    </div>
                                </div>

                                <!-- Small Groups Tab -->
                                <div class="tab-pane fade" id="small-groups" role="tabpanel">
                                    ${this.renderSmallGroupsTab()}
                                </div>

                                <!-- Volunteers Tab -->
                                <div class="tab-pane fade" id="volunteers" role="tabpanel">
                                    ${this.renderVolunteersTab()}
                                </div>

                                <!-- Leaders Tab -->
                                <div class="tab-pane fade" id="leaders" role="tabpanel">
                                    ${this.renderLeadersTab()}
                                </div>
                            </div>
                        </div>
                    </section>
                `;
            }

            getDefaultMinistries() {
                const defaultMinistries = [
                    {
                        id: 'min001',
                        name: 'Youth Ministry',
                        description: 'Engaging teenagers in faith, fellowship, and service through dynamic programs and activities.',
                        leader: 'Sarah Johnson',
                        members: 45,
                        volunteers: 8,
                        leaders: 3,
                        status: 'active',
                        category: 'youth'
                    },
                    {
                        id: 'min002',
                        name: "Children's Ministry",
                        description: 'Nurturing young hearts and minds through age-appropriate Bible lessons and fun activities.',
                        leader: 'Emily Wilson',
                        members: 32,
                        volunteers: 6,
                        leaders: 2,
                        status: 'active',
                        category: 'children'
                    },
                    {
                        id: 'min003',
                        name: 'Worship Team',
                        description: 'Leading the congregation in meaningful worship through music, vocals, and technical support.',
                        leader: 'Michael Davis',
                        members: 18,
                        volunteers: 12,
                        leaders: 3,
                        status: 'active',
                        category: 'worship'
                    },
                    {
                        id: 'min004',
                        name: 'Community Outreach',
                        description: 'Serving our local community through food drives, homeless outreach, and community events.',
                        leader: 'David Rodriguez',
                        members: 28,
                        volunteers: 15,
                        leaders: 4,
                        status: 'active',
                        category: 'outreach'
                    },
                    {
                        id: 'min005',
                        name: 'Prayer Ministry',
                        description: 'Dedicated to intercession, prayer support, and spiritual guidance for our church family.',
                        leader: 'Margaret Thompson',
                        members: 22,
                        volunteers: 8,
                        leaders: 3,
                        status: 'active',
                        category: 'prayer'
                    },
                    {
                        id: 'min006',
                        name: 'Hospitality Ministry',
                        description: 'Creating a welcoming environment through greeting, ushering, and fellowship coordination.',
                        leader: 'Linda Martinez',
                        members: 35,
                        volunteers: 20,
                        leaders: 5,
                        status: 'active',
                        category: 'hospitality'
                    }
                ];

                this.saveToStorage('ministries', defaultMinistries);
                return defaultMinistries;
            }

            renderMinistriesList(ministries) {
                return ministries.map(ministry => `
                    <div class="col-lg-4 col-md-6">
                        <div class="card feature-card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start mb-3">
                                    <div>
                                        <h5 class="card-title">${ministry.name}</h5>
                                        <span class="badge bg-${this.getMinistryBadgeColor(ministry.category)}">${ministry.status}</span>
                                    </div>
                                    <div class="dropdown">
                                        <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="dropdown">
                                            <i class="bi bi-three-dots-vertical"></i>
                                        </button>
                                        <ul class="dropdown-menu">
                                            <li><a class="dropdown-item" href="#" onclick="churchAdmin.editMinistry('${ministry.id}')">Edit</a></li>
                                            <li><a class="dropdown-item" href="#" onclick="churchAdmin.viewMinistryDetails('${ministry.id}')">View Details</a></li>
                                            <li><a class="dropdown-item" href="#" onclick="churchAdmin.manageMinistryMembers('${ministry.id}')">Manage Members</a></li>
                                        </ul>
                                    </div>
                                </div>
                                <p class="card-text">${ministry.description}</p>
                                <div class="ministry-stats">
                                    <div class="row g-2 text-center">
                                        <div class="col-4">
                                            <strong class="text-primary">${ministry.members}</strong>
                                            <br><small class="text-muted">Members</small>
                                        </div>
                                        <div class="col-4">
                                            <strong class="text-success">${ministry.volunteers}</strong>
                                            <br><small class="text-muted">Volunteers</small>
                                        </div>
                                        <div class="col-4">
                                            <strong class="text-info">${ministry.leaders}</strong>
                                            <br><small class="text-muted">Leaders</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <small class="text-muted">Leader: ${ministry.leader}</small>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            getMinistryBadgeColor(category) {
                const colors = {
                    'youth': 'info',
                    'children': 'success',
                    'worship': 'warning',
                    'outreach': 'primary',
                    'prayer': 'secondary',
                    'hospitality': 'success'
                };
                return colors[category] || 'primary';
            }

            renderSmallGroupsTab() {
                const smallGroups = this.getDefaultSmallGroups();

                return `
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Small Groups Management</h4>
                        <button class="btn btn-primary" onclick="churchAdmin.createSmallGroup()">
                            <i class="bi bi-plus me-1"></i>Create Group
                        </button>
                    </div>

                    <div class="row g-4">
                        ${smallGroups.map(group => `
                            <div class="col-lg-6">
                                <div class="card feature-card">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h6 class="mb-0">${group.name}</h6>
                                        <span class="badge bg-primary">${group.members} Members</span>
                                    </div>
                                    <div class="card-body">
                                        <p class="small text-muted mb-2">
                                            <i class="bi bi-calendar me-1"></i>${group.schedule}
                                            <i class="bi bi-geo-alt ms-2 me-1"></i>${group.location}
                                        </p>
                                        <p class="card-text">${group.description}</p>
                                        <div class="d-flex justify-content-between align-items-center">
                                            <small class="text-muted">Leader: ${group.leader}</small>
                                            <div class="btn-group btn-group-sm">
                                                <button class="btn btn-outline-primary" onclick="churchAdmin.manageGroupMembers('${group.id}')">Members</button>
                                                <button class="btn btn-outline-secondary" onclick="churchAdmin.editGroup('${group.id}')">Edit</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            renderVolunteersTab() {
                const volunteers = this.getDefaultVolunteers();

                return `
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Volunteer Management</h4>
                        <div class="btn-group">
                            <button class="btn btn-primary" onclick="churchAdmin.addVolunteer()">
                                <i class="bi bi-person-plus me-1"></i>Add Volunteer
                            </button>
                            <button class="btn btn-outline-primary" onclick="churchAdmin.scheduleVolunteers()">
                                <i class="bi bi-calendar-week me-1"></i>Schedule
                            </button>
                        </div>
                    </div>

                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-dark">
                                <tr>
                                    <th>Name</th>
                                    <th>Ministry</th>
                                    <th>Role</th>
                                    <th>Availability</th>
                                    <th>Last Served</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${volunteers.map(volunteer => `
                                    <tr>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <div class="bg-primary rounded-circle me-2 d-flex align-items-center justify-content-center" style="width: 35px; height: 35px;">
                                                    <i class="bi bi-person text-white"></i>
                                                </div>
                                                <div>
                                                    <strong>${volunteer.name}</strong>
                                                    <br><small class="text-muted">${volunteer.email}</small>
                                                </div>
                                            </div>
                                        </td>
                                        <td>${volunteer.ministry}</td>
                                        <td>${volunteer.role}</td>
                                        <td><span class="badge bg-${volunteer.availability === 'Available' ? 'success' : volunteer.availability === 'Limited' ? 'warning' : 'secondary'}">${volunteer.availability}</span></td>
                                        <td>${volunteer.lastServed}</td>
                                        <td>
                                            <div class="btn-group btn-group-sm">
                                                <button class="btn btn-outline-primary" onclick="churchAdmin.editVolunteer('${volunteer.id}')">Edit</button>
                                                <button class="btn btn-outline-info" onclick="churchAdmin.scheduleVolunteer('${volunteer.id}')">Schedule</button>
                                                <button class="btn btn-outline-success" onclick="churchAdmin.contactVolunteer('${volunteer.id}')">Contact</button>
                                            </div>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            }

            renderLeadersTab() {
                const leaders = this.getDefaultLeaders();

                return `
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Ministry Leaders</h4>
                        <button class="btn btn-primary" onclick="churchAdmin.appointLeader()">
                            <i class="bi bi-person-badge me-1"></i>Appoint Leader
                        </button>
                    </div>

                    <div class="row g-4">
                        ${leaders.map(leader => `
                            <div class="col-lg-4 col-md-6">
                                <div class="card feature-card text-center">
                                    <div class="card-body">
                                        <div class="bg-primary rounded-circle mx-auto mb-3 d-flex align-items-center justify-content-center" style="width: 80px; height: 80px;">
                                            <i class="bi bi-person text-white fs-2"></i>
                                        </div>
                                        <h6>${leader.name}</h6>
                                        <p class="text-muted small">${leader.position}</p>
                                        <p class="small">${leader.ministry}</p>
                                        <p class="small text-muted">Leading since: ${leader.startDate}</p>
                                        <div class="btn-group btn-group-sm">
                                            <button class="btn btn-outline-primary" onclick="churchAdmin.viewLeaderProfile('${leader.id}')">Profile</button>
                                            <button class="btn btn-outline-secondary" onclick="churchAdmin.contactLeader('${leader.id}')">Contact</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            getDefaultSmallGroups() {
                return [
                    {
                        id: 'sg001',
                        name: "Men's Bible Study",
                        schedule: 'Thursdays 7:00 PM',
                        location: 'Conference Room A',
                        description: 'Weekly Bible study focusing on practical Christian living and brotherhood.',
                        leader: 'John Smith',
                        members: 8
                    },
                    {
                        id: 'sg002',
                        name: "Women's Fellowship",
                        schedule: 'Tuesdays 10:00 AM',
                        location: 'Fellowship Hall',
                        description: 'Bible study and fellowship for women of all ages with childcare provided.',
                        leader: 'Mary Johnson',
                        members: 12
                    },
                    {
                        id: 'sg003',
                        name: 'Young Adults Group',
                        schedule: 'Fridays 7:30 PM',
                        location: 'Youth Center',
                        description: 'Fellowship and Bible study for adults aged 18-35.',
                        leader: 'David Wilson',
                        members: 15
                    },
                    {
                        id: 'sg004',
                        name: 'Seniors Fellowship',
                        schedule: 'Wednesdays 2:00 PM',
                        location: 'Senior Center',
                        description: 'Bible study and fellowship for our senior members.',
                        leader: 'Robert Thompson',
                        members: 18
                    }
                ];
            }

            getDefaultVolunteers() {
                return [
                    {
                        id: 'vol001',
                        name: 'John Smith',
                        email: 'john.smith@email.com',
                        ministry: 'Worship Team',
                        role: 'Sound Technician',
                        availability: 'Available',
                        lastServed: 'Dec 10, 2024'
                    },
                    {
                        id: 'vol002',
                        name: 'Sarah Wilson',
                        email: 'sarah.wilson@email.com',
                        ministry: "Children's Ministry",
                        role: 'Teacher',
                        availability: 'Limited',
                        lastServed: 'Dec 8, 2024'
                    },
                    {
                        id: 'vol003',
                        name: 'Michael Davis',
                        email: 'michael.davis@email.com',
                        ministry: 'Hospitality',
                        role: 'Greeter',
                        availability: 'Available',
                        lastServed: 'Dec 10, 2024'
                    },
                    {
                        id: 'vol004',
                        name: 'Emily Rodriguez',
                        email: 'emily.rodriguez@email.com',
                        ministry: 'Youth Ministry',
                        role: 'Assistant Leader',
                        availability: 'Available',
                        lastServed: 'Dec 9, 2024'
                    },
                    {
                        id: 'vol005',
                        name: 'David Martinez',
                        email: 'david.martinez@email.com',
                        ministry: 'Community Outreach',
                        role: 'Coordinator',
                        availability: 'Unavailable',
                        lastServed: 'Nov 28, 2024'
                    }
                ];
            }

            getDefaultLeaders() {
                return [
                    {
                        id: 'leader001',
                        name: 'Sarah Johnson',
                        position: 'Youth Ministry Leader',
                        ministry: 'Youth Ministry',
                        startDate: 'January 2020'
                    },
                    {
                        id: 'leader002',
                        name: 'Michael Davis',
                        position: 'Worship Leader',
                        ministry: 'Worship Team',
                        startDate: 'March 2019'
                    },
                    {
                        id: 'leader003',
                        name: 'Emily Wilson',
                        position: 'Children\'s Director',
                        ministry: "Children's Ministry",
                        startDate: 'September 2021'
                    },
                    {
                        id: 'leader004',
                        name: 'David Rodriguez',
                        position: 'Outreach Coordinator',
                        ministry: 'Community Outreach',
                        startDate: 'June 2020'
                    },
                    {
                        id: 'leader005',
                        name: 'Margaret Thompson',
                        position: 'Prayer Ministry Leader',
                        ministry: 'Prayer Ministry',
                        startDate: 'August 2018'
                    },
                    {
                        id: 'leader006',
                        name: 'Linda Martinez',
                        position: 'Hospitality Coordinator',
                        ministry: 'Hospitality Ministry',
                        startDate: 'February 2022'
                    }
                ];
            }

            renderCommunicationsSection() {
                const announcements = this.getDefaultAnnouncements();
                const newsletters = this.getDefaultNewsletters();
                const prayerRequests = this.getDefaultPrayerRequests();

                return `
                    <section class="content-section">
                        <div class="container">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div>
                                    <h2>Communications Management</h2>
                                    <p class="mb-0">Manage church communications, announcements, and member outreach</p>
                                </div>
                                <div class="btn-group">
                                    <button class="btn btn-primary" onclick="churchAdmin.createAnnouncement()">
                                        <i class="bi bi-megaphone me-1"></i>New Announcement
                                    </button>
                                    <button class="btn btn-outline-primary" onclick="churchAdmin.sendBulkEmail()">
                                        <i class="bi bi-envelope-at me-1"></i>Bulk Email
                                    </button>
                                    <button class="btn btn-outline-secondary" onclick="churchAdmin.manageTemplates()">
                                        <i class="bi bi-file-text me-1"></i>Templates
                                    </button>
                                </div>
                            </div>

                            <!-- Communication Stats -->
                            <div class="row g-4 mb-5">
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-envelope text-primary fs-1 mb-2"></i>
                                            <h4 class="text-primary">1,247</h4>
                                            <h6>Emails Sent This Month</h6>
                                            <small class="text-success">+15% from last month</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-people text-success fs-1 mb-2"></i>
                                            <h4 class="text-success">456</h4>
                                            <h6>Newsletter Subscribers</h6>
                                            <small class="text-success">+23 new this month</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-chat-dots text-info fs-1 mb-2"></i>
                                            <h4 class="text-info">${prayerRequests.length}</h4>
                                            <h6>Prayer Requests</h6>
                                            <small class="text-info">This month</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-megaphone text-warning fs-1 mb-2"></i>
                                            <h4 class="text-warning">${announcements.length}</h4>
                                            <h6>Active Announcements</h6>
                                            <small class="text-warning">Currently published</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Communication Tabs -->
                            <ul class="nav nav-tabs mb-4" id="communicationTabs" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="announcements-tab" data-bs-toggle="tab" data-bs-target="#announcements" type="button">
                                        Announcements
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="newsletters-tab" data-bs-toggle="tab" data-bs-target="#newsletters" type="button">
                                        Newsletters
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="prayer-requests-tab" data-bs-toggle="tab" data-bs-target="#prayer-requests" type="button">
                                        Prayer Requests
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="bulk-messaging-tab" data-bs-toggle="tab" data-bs-target="#bulk-messaging" type="button">
                                        Bulk Messaging
                                    </button>
                                </li>
                            </ul>

                            <!-- Tab Content -->
                            <div class="tab-content" id="communicationTabContent">
                                <!-- Announcements Tab -->
                                <div class="tab-pane fade show active" id="announcements" role="tabpanel">
                                    ${this.renderAnnouncementsTab(announcements)}
                                </div>

                                <!-- Newsletters Tab -->
                                <div class="tab-pane fade" id="newsletters" role="tabpanel">
                                    ${this.renderNewslettersTab(newsletters)}
                                </div>

                                <!-- Prayer Requests Tab -->
                                <div class="tab-pane fade" id="prayer-requests" role="tabpanel">
                                    ${this.renderPrayerRequestsTab(prayerRequests)}
                                </div>

                                <!-- Bulk Messaging Tab -->
                                <div class="tab-pane fade" id="bulk-messaging" role="tabpanel">
                                    ${this.renderBulkMessagingTab()}
                                </div>
                            </div>
                        </div>
                    </section>
                `;
            }

            renderAnnouncementsTab(announcements) {
                return `
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Church Announcements</h4>
                        <button class="btn btn-primary" onclick="churchAdmin.createAnnouncement()">
                            <i class="bi bi-plus me-1"></i>Create Announcement
                        </button>
                    </div>

                    <div class="row g-4">
                        <div class="col-lg-8">
                            <div class="card feature-card">
                                <div class="card-header">
                                    <h6 class="mb-0">Active Announcements</h6>
                                </div>
                                <div class="card-body">
                                    ${announcements.map(announcement => `
                                        <div class="announcement-item border-bottom pb-3 mb-3">
                                            <div class="d-flex justify-content-between align-items-start">
                                                <div class="flex-grow-1">
                                                    <h6 class="mb-1">${announcement.title}</h6>
                                                    <p class="mb-2">${announcement.content}</p>
                                                    <small class="text-muted">
                                                        <i class="bi bi-calendar me-1"></i>Posted: ${announcement.date}
                                                        <i class="bi bi-eye ms-3 me-1"></i>Views: ${announcement.views}
                                                    </small>
                                                </div>
                                                <div class="btn-group btn-group-sm">
                                                    <button class="btn btn-outline-primary" onclick="churchAdmin.editAnnouncement('${announcement.id}')">
                                                        <i class="bi bi-pencil"></i>
                                                    </button>
                                                    <button class="btn btn-outline-danger" onclick="churchAdmin.deleteAnnouncement('${announcement.id}')">
                                                        <i class="bi bi-trash"></i>
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="mt-2">
                                                <span class="badge bg-success">Active</span>
                                                <span class="badge bg-info">Website</span>
                                                <span class="badge bg-warning text-dark">Email</span>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-4">
                            <div class="card feature-card">
                                <div class="card-header">
                                    <h6 class="mb-0">Quick Actions</h6>
                                </div>
                                <div class="card-body">
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-primary" onclick="churchAdmin.createUrgentAnnouncement()">
                                            <i class="bi bi-exclamation-triangle me-1"></i>Urgent Announcement
                                        </button>
                                        <button class="btn btn-outline-primary" onclick="churchAdmin.scheduleAnnouncement()">
                                            <i class="bi bi-clock me-1"></i>Schedule Announcement
                                        </button>
                                        <button class="btn btn-outline-secondary" onclick="churchAdmin.viewAnnouncementAnalytics()">
                                            <i class="bi bi-graph-up me-1"></i>View Analytics
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="card feature-card mt-4">
                                <div class="card-header">
                                    <h6 class="mb-0">Quick Templates</h6>
                                </div>
                                <div class="card-body">
                                    <div class="list-group list-group-flush">
                                        <button class="list-group-item list-group-item-action" onclick="churchAdmin.useTemplate('service-change')">
                                            Service Time Change
                                        </button>
                                        <button class="list-group-item list-group-item-action" onclick="churchAdmin.useTemplate('event-reminder')">
                                            Event Reminder
                                        </button>
                                        <button class="list-group-item list-group-item-action" onclick="churchAdmin.useTemplate('weather-closure')">
                                            Weather Closure
                                        </button>
                                        <button class="list-group-item list-group-item-action" onclick="churchAdmin.useTemplate('volunteer-needed')">
                                            Volunteers Needed
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            renderNewslettersTab(newsletters) {
                return `
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Newsletter Management</h4>
                        <div class="btn-group">
                            <button class="btn btn-primary" onclick="churchAdmin.createNewsletter()">
                                <i class="bi bi-plus me-1"></i>Create Newsletter
                            </button>
                            <button class="btn btn-outline-primary" onclick="churchAdmin.manageSubscribers()">
                                <i class="bi bi-people me-1"></i>Manage Subscribers
                            </button>
                        </div>
                    </div>

                    <div class="row g-4">
                        <div class="col-lg-8">
                            <div class="card feature-card">
                                <div class="card-header">
                                    <h6 class="mb-0">Recent Newsletters</h6>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr>
                                                    <th>Title</th>
                                                    <th>Date Sent</th>
                                                    <th>Recipients</th>
                                                    <th>Open Rate</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                ${newsletters.map(newsletter => `
                                                    <tr>
                                                        <td>${newsletter.title}</td>
                                                        <td>${newsletter.dateSent}</td>
                                                        <td>${newsletter.recipients}</td>
                                                        <td><span class="badge bg-success">${newsletter.openRate}</span></td>
                                                        <td>
                                                            <div class="btn-group btn-group-sm">
                                                                <button class="btn btn-outline-primary" onclick="churchAdmin.viewNewsletter('${newsletter.id}')">View</button>
                                                                <button class="btn btn-outline-secondary" onclick="churchAdmin.duplicateNewsletter('${newsletter.id}')">Duplicate</button>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                `).join('')}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-4">
                            <div class="card feature-card">
                                <div class="card-header">
                                    <h6 class="mb-0">Subscriber Stats</h6>
                                </div>
                                <div class="card-body">
                                    <div class="stat-item mb-3">
                                        <h4 class="text-primary mb-0">456</h4>
                                        <small class="text-muted">Total Subscribers</small>
                                    </div>
                                    <div class="stat-item mb-3">
                                        <h4 class="text-success mb-0">23</h4>
                                        <small class="text-muted">New This Month</small>
                                    </div>
                                    <div class="stat-item mb-3">
                                        <h4 class="text-info mb-0">79%</h4>
                                        <small class="text-muted">Average Open Rate</small>
                                    </div>
                                    <button class="btn btn-outline-primary btn-sm w-100" onclick="churchAdmin.exportSubscribers()">
                                        <i class="bi bi-download me-1"></i>Export List
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            renderPrayerRequestsTab(prayerRequests) {
                return `
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Prayer Request Management</h4>
                        <div class="btn-group">
                            <button class="btn btn-primary" onclick="churchAdmin.addPrayerRequest()">
                                <i class="bi bi-plus me-1"></i>Add Request
                            </button>
                            <button class="btn btn-outline-primary" onclick="churchAdmin.prayerRequestSettings()">
                                <i class="bi bi-gear me-1"></i>Settings
                            </button>
                        </div>
                    </div>

                    <div class="row g-4">
                        <div class="col-lg-8">
                            <div class="card feature-card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h6 class="mb-0">Recent Prayer Requests</h6>
                                    <div class="btn-group btn-group-sm">
                                        <button class="btn btn-outline-primary active" onclick="churchAdmin.filterPrayerRequests('all')">All</button>
                                        <button class="btn btn-outline-primary" onclick="churchAdmin.filterPrayerRequests('pending')">Pending</button>
                                        <button class="btn btn-outline-primary" onclick="churchAdmin.filterPrayerRequests('approved')">Approved</button>
                                    </div>
                                </div>
                                <div class="card-body">
                                    ${prayerRequests.map(request => `
                                        <div class="prayer-request-item border-bottom pb-3 mb-3">
                                            <div class="d-flex justify-content-between align-items-start">
                                                <div class="flex-grow-1">
                                                    <h6 class="mb-1">${request.title}</h6>
                                                    <p class="mb-2">${request.content}</p>
                                                    <small class="text-muted">
                                                        Submitted by: ${request.submittedBy} • ${request.date}
                                                    </small>
                                                </div>
                                                <div class="btn-group btn-group-sm">
                                                    <button class="btn btn-outline-success" onclick="churchAdmin.approvePrayerRequest('${request.id}')">
                                                        <i class="bi bi-check"></i>
                                                    </button>
                                                    <button class="btn btn-outline-primary" onclick="churchAdmin.editPrayerRequest('${request.id}')">
                                                        <i class="bi bi-pencil"></i>
                                                    </button>
                                                    <button class="btn btn-outline-danger" onclick="churchAdmin.deletePrayerRequest('${request.id}')">
                                                        <i class="bi bi-trash"></i>
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="mt-2">
                                                <span class="badge bg-${request.status === 'pending' ? 'warning' : 'success'}">${request.status}</span>
                                                <span class="badge bg-info">${request.category}</span>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-4">
                            <div class="card feature-card">
                                <div class="card-header">
                                    <h6 class="mb-0">Prayer Request Stats</h6>
                                </div>
                                <div class="card-body">
                                    <div class="stat-item mb-3">
                                        <h4 class="text-primary mb-0">${prayerRequests.length}</h4>
                                        <small class="text-muted">Total This Month</small>
                                    </div>
                                    <div class="stat-item mb-3">
                                        <h4 class="text-warning mb-0">${prayerRequests.filter(r => r.status === 'pending').length}</h4>
                                        <small class="text-muted">Pending Review</small>
                                    </div>
                                    <div class="stat-item mb-3">
                                        <h4 class="text-success mb-0">${prayerRequests.filter(r => r.status === 'approved').length}</h4>
                                        <small class="text-muted">Approved & Published</small>
                                    </div>
                                </div>
                            </div>

                            <div class="card feature-card mt-4">
                                <div class="card-header">
                                    <h6 class="mb-0">Categories</h6>
                                </div>
                                <div class="card-body">
                                    <div class="category-item d-flex justify-content-between mb-2">
                                        <span>Health & Healing</span>
                                        <span class="badge bg-primary">34</span>
                                    </div>
                                    <div class="category-item d-flex justify-content-between mb-2">
                                        <span>Family</span>
                                        <span class="badge bg-success">23</span>
                                    </div>
                                    <div class="category-item d-flex justify-content-between mb-2">
                                        <span>Thanksgiving</span>
                                        <span class="badge bg-warning text-dark">18</span>
                                    </div>
                                    <div class="category-item d-flex justify-content-between mb-2">
                                        <span>Work & Finance</span>
                                        <span class="badge bg-info">14</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            renderBulkMessagingTab() {
                return `
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Bulk Messaging</h4>
                        <button class="btn btn-primary" onclick="churchAdmin.composeBulkMessage()">
                            <i class="bi bi-envelope-plus me-1"></i>Compose Message
                        </button>
                    </div>

                    <div class="row g-4">
                        <div class="col-lg-8">
                            <div class="card feature-card">
                                <div class="card-header">
                                    <h6 class="mb-0">Recent Bulk Messages</h6>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr>
                                                    <th>Subject</th>
                                                    <th>Recipients</th>
                                                    <th>Sent Date</th>
                                                    <th>Delivery Rate</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>Christmas Service Schedule</td>
                                                    <td>487 members</td>
                                                    <td>Dec 5, 2024</td>
                                                    <td><span class="badge bg-success">96%</span></td>
                                                    <td>
                                                        <button class="btn btn-sm btn-outline-primary" onclick="churchAdmin.viewMessageStats('msg001')">Stats</button>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>Youth Ministry Update</td>
                                                    <td>45 youth families</td>
                                                    <td>Dec 3, 2024</td>
                                                    <td><span class="badge bg-success">94%</span></td>
                                                    <td>
                                                        <button class="btn btn-sm btn-outline-primary" onclick="churchAdmin.viewMessageStats('msg002')">Stats</button>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-4">
                            <div class="card feature-card">
                                <div class="card-header">
                                    <h6 class="mb-0">Recipient Groups</h6>
                                </div>
                                <div class="card-body">
                                    <div class="list-group list-group-flush">
                                        <div class="list-group-item d-flex justify-content-between align-items-center">
                                            All Members
                                            <span class="badge bg-primary">487</span>
                                        </div>
                                        <div class="list-group-item d-flex justify-content-between align-items-center">
                                            Newsletter Subscribers
                                            <span class="badge bg-success">456</span>
                                        </div>
                                        <div class="list-group-item d-flex justify-content-between align-items-center">
                                            Youth Families
                                            <span class="badge bg-info">45</span>
                                        </div>
                                        <div class="list-group-item d-flex justify-content-between align-items-center">
                                            Volunteers
                                            <span class="badge bg-warning text-dark">89</span>
                                        </div>
                                        <div class="list-group-item d-flex justify-content-between align-items-center">
                                            Ministry Leaders
                                            <span class="badge bg-secondary">23</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            getDefaultAnnouncements() {
                return [
                    {
                        id: 'ann001',
                        title: 'Christmas Eve Service',
                        content: 'Join us for our special Christmas Eve candlelight service on December 24th at 7:00 PM.',
                        date: 'Dec 1, 2024',
                        views: 234
                    },
                    {
                        id: 'ann002',
                        title: 'Youth Christmas Party',
                        content: 'All youth are invited to our Christmas party on December 15th. Food, games, and fellowship!',
                        date: 'Nov 28, 2024',
                        views: 156
                    },
                    {
                        id: 'ann003',
                        title: 'Community Food Drive',
                        content: 'Help us collect food donations for local families in need. Drop-off points available in the lobby.',
                        date: 'Nov 25, 2024',
                        views: 189
                    }
                ];
            }

            getDefaultNewsletters() {
                return [
                    {
                        id: 'news001',
                        title: 'December Newsletter',
                        dateSent: 'Dec 1, 2024',
                        recipients: 456,
                        openRate: '78%'
                    },
                    {
                        id: 'news002',
                        title: 'Thanksgiving Special',
                        dateSent: 'Nov 20, 2024',
                        recipients: 432,
                        openRate: '82%'
                    },
                    {
                        id: 'news003',
                        title: 'November Newsletter',
                        dateSent: 'Nov 1, 2024',
                        recipients: 445,
                        openRate: '75%'
                    }
                ];
            }

            getDefaultPrayerRequests() {
                return [
                    {
                        id: 'pr001',
                        title: "Healing for John's Surgery",
                        content: 'Please pray for John Smith as he undergoes surgery this week. Pray for the medical team and quick recovery.',
                        submittedBy: 'Mary Johnson',
                        date: 'Dec 8, 2024',
                        status: 'pending',
                        category: 'Health'
                    },
                    {
                        id: 'pr002',
                        title: 'Thanksgiving for New Job',
                        content: 'Praise God! Sarah found a new job after months of searching. Thank you for your prayers.',
                        submittedBy: 'Sarah Wilson',
                        date: 'Dec 7, 2024',
                        status: 'approved',
                        category: 'Thanksgiving'
                    },
                    {
                        id: 'pr003',
                        title: 'Family Reconciliation',
                        content: 'Please pray for healing and reconciliation in the Martinez family during this difficult time.',
                        submittedBy: 'Anonymous',
                        date: 'Dec 6, 2024',
                        status: 'approved',
                        category: 'Family'
                    },
                    {
                        id: 'pr004',
                        title: 'Financial Provision',
                        content: 'Pray for God\'s provision for the Johnson family as they face unexpected medical expenses.',
                        submittedBy: 'Pastor John',
                        date: 'Dec 5, 2024',
                        status: 'pending',
                        category: 'Finance'
                    }
                ];
            }

            renderMediaSection() {
                const sermons = this.getDefaultSermons();
                const documents = this.getDefaultDocuments();

                return `
                    <section class="content-section">
                        <div class="container">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div>
                                    <h2>Media & Resources Management</h2>
                                    <p class="mb-0">Manage sermons, media files, documents, and digital resources</p>
                                </div>
                                <div class="btn-group">
                                    <button class="btn btn-primary" onclick="churchAdmin.uploadMedia()">
                                        <i class="bi bi-cloud-upload me-1"></i>Upload Media
                                    </button>
                                    <button class="btn btn-outline-primary" onclick="churchAdmin.addSermon()">
                                        <i class="bi bi-mic me-1"></i>Add Sermon
                                    </button>
                                    <button class="btn btn-outline-secondary" onclick="churchAdmin.organizeLibrary()">
                                        <i class="bi bi-folder-plus me-1"></i>Organize
                                    </button>
                                </div>
                            </div>

                            <!-- Media Stats -->
                            <div class="row g-4 mb-5">
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-play-circle text-primary fs-1 mb-2"></i>
                                            <h4 class="text-primary">${sermons.length}</h4>
                                            <h6>Total Sermons</h6>
                                            <small class="text-success">+4 this month</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-image text-success fs-1 mb-2"></i>
                                            <h4 class="text-success">342</h4>
                                            <h6>Photos & Images</h6>
                                            <small class="text-success">+23 this month</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-file-earmark-text text-info fs-1 mb-2"></i>
                                            <h4 class="text-info">${documents.length}</h4>
                                            <h6>Documents</h6>
                                            <small class="text-info">Study guides, forms</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <div class="card feature-card text-center">
                                        <div class="card-body">
                                            <i class="bi bi-download text-warning fs-1 mb-2"></i>
                                            <h4 class="text-warning">1,247</h4>
                                            <h6>Total Downloads</h6>
                                            <small class="text-warning">This month</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Media Management Tabs -->
                            <ul class="nav nav-tabs mb-4" id="mediaTabs" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="sermons-tab" data-bs-toggle="tab" data-bs-target="#sermons" type="button">
                                        Sermons
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="media-library-tab" data-bs-toggle="tab" data-bs-target="#media-library" type="button">
                                        Media Library
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="documents-tab" data-bs-toggle="tab" data-bs-target="#documents" type="button">
                                        Documents
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="live-streaming-tab" data-bs-toggle="tab" data-bs-target="#live-streaming" type="button">
                                        Live Streaming
                                    </button>
                                </li>
                            </ul>

                            <!-- Tab Content -->
                            <div class="tab-content" id="mediaTabContent">
                                <!-- Sermons Tab -->
                                <div class="tab-pane fade show active" id="sermons" role="tabpanel">
                                    ${this.renderSermonsTab(sermons)}
                                </div>

                                <!-- Media Library Tab -->
                                <div class="tab-pane fade" id="media-library" role="tabpanel">
                                    ${this.renderMediaLibraryTab()}
                                </div>

                                <!-- Documents Tab -->
                                <div class="tab-pane fade" id="documents" role="tabpanel">
                                    ${this.renderDocumentsTab(documents)}
                                </div>

                                <!-- Live Streaming Tab -->
                                <div class="tab-pane fade" id="live-streaming" role="tabpanel">
                                    ${this.renderLiveStreamingTab()}
                                </div>
                            </div>
                        </div>
                    </section>
                `;
            }

            renderSermonsTab(sermons) {
                return `
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Sermon Archive</h4>
                        <div class="btn-group">
                            <button class="btn btn-primary" onclick="churchAdmin.addSermon()">
                                <i class="bi bi-plus me-1"></i>Add Sermon
                            </button>
                            <button class="btn btn-outline-primary" onclick="churchAdmin.importSermons()">
                                <i class="bi bi-upload me-1"></i>Import
                            </button>
                            <button class="btn btn-outline-secondary" onclick="churchAdmin.exportSermons()">
                                <i class="bi bi-download me-1"></i>Export
                            </button>
                        </div>
                    </div>

                    <!-- Sermon Filters -->
                    <div class="row mb-4">
                        <div class="col-lg-6">
                            <div class="input-group">
                                <input type="text" class="form-control" placeholder="Search sermons..." id="sermonSearch">
                                <button class="btn btn-outline-secondary" type="button">
                                    <i class="bi bi-search"></i>
                                </button>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="row g-2">
                                <div class="col-md-6">
                                    <select class="form-select" id="sermonSeries">
                                        <option value="">All Series</option>
                                        <option value="advent-2024">Advent 2024</option>
                                        <option value="faith-foundations">Faith Foundations</option>
                                        <option value="psalms-study">Psalms Study</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <select class="form-select" id="sermonSpeaker">
                                        <option value="">All Speakers</option>
                                        <option value="pastor-john">Pastor John Smith</option>
                                        <option value="pastor-sarah">Pastor Sarah Johnson</option>
                                        <option value="guest-speakers">Guest Speakers</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sermons List -->
                    <div class="row g-4">
                        ${sermons.map(sermon => `
                            <div class="col-lg-6">
                                <div class="card feature-card">
                                    <div class="row g-0">
                                        <div class="col-md-4">
                                            <div class="sermon-thumbnail position-relative">
                                                <div class="bg-primary d-flex align-items-center justify-content-center h-100">
                                                    <i class="bi bi-play-circle text-white" style="font-size: 3rem;"></i>
                                                </div>
                                                <div class="play-overlay">
                                                    <button class="btn btn-primary btn-lg rounded-circle" onclick="churchAdmin.playSermon('${sermon.id}')">
                                                        <i class="bi bi-play-fill"></i>
                                                    </button>
                                                </div>
                                                <div class="duration-badge">
                                                    <span class="badge bg-dark">${sermon.duration}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-8">
                                            <div class="card-body">
                                                <h6 class="card-title">${sermon.title}</h6>
                                                <p class="card-text small text-muted mb-2">
                                                    <i class="bi bi-person me-1"></i>${sermon.speaker}
                                                    <i class="bi bi-calendar ms-2 me-1"></i>${sermon.date}
                                                </p>
                                                <p class="card-text small">${sermon.description}</p>
                                                <div class="sermon-stats small text-muted mb-2">
                                                    <i class="bi bi-eye me-1"></i>${sermon.views} views
                                                    <i class="bi bi-download ms-2 me-1"></i>${sermon.downloads} downloads
                                                </div>
                                                <div class="btn-group btn-group-sm">
                                                    <button class="btn btn-outline-primary" onclick="churchAdmin.editSermon('${sermon.id}')" title="Edit">
                                                        <i class="bi bi-pencil"></i>
                                                    </button>
                                                    <button class="btn btn-outline-success" onclick="churchAdmin.downloadSermon('${sermon.id}')" title="Download">
                                                        <i class="bi bi-download"></i>
                                                    </button>
                                                    <button class="btn btn-outline-info" onclick="churchAdmin.shareSermon('${sermon.id}')" title="Share">
                                                        <i class="bi bi-share"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            getDefaultSermons() {
                return [
                    {
                        id: 'sermon001',
                        title: 'Hope in the Darkness',
                        speaker: 'Pastor John Smith',
                        date: 'Dec 10, 2024',
                        duration: '32:15',
                        description: 'First sermon in our Advent series exploring the theme of hope during challenging times.',
                        views: 234,
                        downloads: 45,
                        series: 'advent-2024'
                    },
                    {
                        id: 'sermon002',
                        title: 'Grateful Hearts',
                        speaker: 'Pastor Sarah Johnson',
                        date: 'Nov 26, 2024',
                        duration: '28:42',
                        description: 'A Thanksgiving message about cultivating gratitude in all circumstances.',
                        views: 189,
                        downloads: 67,
                        series: 'faith-foundations'
                    },
                    {
                        id: 'sermon003',
                        title: 'Walking by Faith',
                        speaker: 'Pastor John Smith',
                        date: 'Nov 19, 2024',
                        duration: '35:18',
                        description: 'Understanding what it means to live by faith rather than sight.',
                        views: 156,
                        downloads: 52,
                        series: 'faith-foundations'
                    },
                    {
                        id: 'sermon004',
                        title: 'The Good Shepherd',
                        speaker: 'Guest Speaker - Rev. Michael Brown',
                        date: 'Nov 12, 2024',
                        duration: '29:33',
                        description: 'Exploring Psalm 23 and God\'s care for His people.',
                        views: 203,
                        downloads: 38,
                        series: 'psalms-study'
                    }
                ];
            }

            renderMediaLibraryTab() {
                return `
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Media Library</h4>
                        <div class="btn-group">
                            <button class="btn btn-primary" onclick="churchAdmin.uploadMedia()">
                                <i class="bi bi-cloud-upload me-1"></i>Upload Files
                            </button>
                            <button class="btn btn-outline-primary" onclick="churchAdmin.createFolder()">
                                <i class="bi bi-folder-plus me-1"></i>New Folder
                            </button>
                        </div>
                    </div>

                    <!-- Media Folders -->
                    <div class="row g-4 mb-4">
                        <div class="col-lg-2 col-md-3 col-6">
                            <div class="media-folder" onclick="churchAdmin.openFolder('photos')">
                                <i class="bi bi-folder text-primary fs-1 mb-2"></i>
                                <h6>Photos</h6>
                                <small class="text-muted">342 files</small>
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-3 col-6">
                            <div class="media-folder" onclick="churchAdmin.openFolder('videos')">
                                <i class="bi bi-folder text-success fs-1 mb-2"></i>
                                <h6>Videos</h6>
                                <small class="text-muted">28 files</small>
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-3 col-6">
                            <div class="media-folder" onclick="churchAdmin.openFolder('audio')">
                                <i class="bi bi-folder text-warning fs-1 mb-2"></i>
                                <h6>Audio</h6>
                                <small class="text-muted">156 files</small>
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-3 col-6">
                            <div class="media-folder" onclick="churchAdmin.openFolder('graphics')">
                                <i class="bi bi-folder text-info fs-1 mb-2"></i>
                                <h6>Graphics</h6>
                                <small class="text-muted">89 files</small>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Media Files -->
                    <h5 class="mb-3">Recent Uploads</h5>
                    <div class="row g-3">
                        ${this.getRecentMediaFiles().map(file => `
                            <div class="col-lg-2 col-md-3 col-4">
                                <div class="media-item">
                                    <div class="media-thumbnail">
                                        <div class="file-icon bg-${this.getFileTypeColor(file.type)}">
                                            <i class="bi bi-${this.getFileTypeIcon(file.type)} text-white fs-2"></i>
                                        </div>
                                        <div class="media-overlay">
                                            <button class="btn btn-sm btn-light" onclick="churchAdmin.previewFile('${file.id}')" title="Preview">
                                                <i class="bi bi-eye"></i>
                                            </button>
                                            <button class="btn btn-sm btn-light" onclick="churchAdmin.downloadFile('${file.id}')" title="Download">
                                                <i class="bi bi-download"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="mt-2 text-center">
                                        <small class="text-truncate d-block">${file.name}</small>
                                        <small class="text-muted">${file.size}</small>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            renderDocumentsTab(documents) {
                return `
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Document Library</h4>
                        <div class="btn-group">
                            <button class="btn btn-primary" onclick="churchAdmin.uploadDocument()">
                                <i class="bi bi-file-plus me-1"></i>Upload Document
                            </button>
                            <button class="btn btn-outline-primary" onclick="churchAdmin.createDocument()">
                                <i class="bi bi-file-text me-1"></i>Create New
                            </button>
                        </div>
                    </div>

                    <div class="row g-4">
                        <div class="col-lg-8">
                            <div class="card feature-card">
                                <div class="card-header">
                                    <h6 class="mb-0">Document Library</h6>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr>
                                                    <th>Name</th>
                                                    <th>Type</th>
                                                    <th>Category</th>
                                                    <th>Modified</th>
                                                    <th>Downloads</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                ${documents.map(doc => `
                                                    <tr>
                                                        <td>
                                                            <div class="d-flex align-items-center">
                                                                <i class="bi bi-${this.getFileTypeIcon(doc.type)} text-primary me-2"></i>
                                                                ${doc.name}
                                                            </div>
                                                        </td>
                                                        <td><span class="badge bg-secondary">${doc.type.toUpperCase()}</span></td>
                                                        <td>${doc.category}</td>
                                                        <td>${doc.modified}</td>
                                                        <td>${doc.downloads}</td>
                                                        <td>
                                                            <div class="btn-group btn-group-sm">
                                                                <button class="btn btn-outline-primary" onclick="churchAdmin.editDocument('${doc.id}')" title="Edit">
                                                                    <i class="bi bi-pencil"></i>
                                                                </button>
                                                                <button class="btn btn-outline-success" onclick="churchAdmin.downloadDocument('${doc.id}')" title="Download">
                                                                    <i class="bi bi-download"></i>
                                                                </button>
                                                                <button class="btn btn-outline-info" onclick="churchAdmin.shareDocument('${doc.id}')" title="Share">
                                                                    <i class="bi bi-share"></i>
                                                                </button>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                `).join('')}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-4">
                            <div class="card feature-card">
                                <div class="card-header">
                                    <h6 class="mb-0">Document Categories</h6>
                                </div>
                                <div class="card-body">
                                    <div class="list-group list-group-flush">
                                        <div class="list-group-item d-flex justify-content-between align-items-center">
                                            Study Guides
                                            <span class="badge bg-primary">12</span>
                                        </div>
                                        <div class="list-group-item d-flex justify-content-between align-items-center">
                                            Forms & Applications
                                            <span class="badge bg-success">8</span>
                                        </div>
                                        <div class="list-group-item d-flex justify-content-between align-items-center">
                                            Ministry Resources
                                            <span class="badge bg-info">15</span>
                                        </div>
                                        <div class="list-group-item d-flex justify-content-between align-items-center">
                                            Policies & Procedures
                                            <span class="badge bg-warning text-dark">6</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            renderLiveStreamingTab() {
                return `
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Live Streaming Management</h4>
                        <div class="btn-group">
                            <button class="btn btn-success" onclick="churchAdmin.startLiveStream()">
                                <i class="bi bi-broadcast me-1"></i>Start Stream
                            </button>
                            <button class="btn btn-outline-primary" onclick="churchAdmin.scheduleLiveStream()">
                                <i class="bi bi-calendar-plus me-1"></i>Schedule Stream
                            </button>
                        </div>
                    </div>

                    <div class="row g-4">
                        <div class="col-lg-8">
                            <div class="card feature-card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h6 class="mb-0">Live Stream Status</h6>
                                    <span class="badge bg-danger">Offline</span>
                                </div>
                                <div class="card-body text-center">
                                    <div class="stream-preview bg-dark rounded mb-3" style="height: 300px; display: flex; align-items: center; justify-content: center;">
                                        <div class="text-white">
                                            <i class="bi bi-camera-video-off fs-1 mb-3"></i>
                                            <h5>Stream Offline</h5>
                                            <p>Click "Start Stream" to begin broadcasting</p>
                                        </div>
                                    </div>
                                    <div class="stream-controls">
                                        <button class="btn btn-success me-2" onclick="churchAdmin.startLiveStream()">
                                            <i class="bi bi-play-circle me-1"></i>Start Stream
                                        </button>
                                        <button class="btn btn-outline-secondary me-2" onclick="churchAdmin.testStream()">
                                            <i class="bi bi-gear me-1"></i>Test Stream
                                        </button>
                                        <button class="btn btn-outline-info" onclick="churchAdmin.streamSettings()">
                                            <i class="bi bi-sliders me-1"></i>Settings
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-4">
                            <div class="card feature-card">
                                <div class="card-header">
                                    <h6 class="mb-0">Stream Statistics</h6>
                                </div>
                                <div class="card-body">
                                    <div class="stat-item mb-3">
                                        <h4 class="text-primary mb-0">0</h4>
                                        <small class="text-muted">Current Viewers</small>
                                    </div>
                                    <div class="stat-item mb-3">
                                        <h4 class="text-success mb-0">247</h4>
                                        <small class="text-muted">Peak Viewers (Last Stream)</small>
                                    </div>
                                    <div class="stat-item mb-3">
                                        <h4 class="text-info mb-0">1,456</h4>
                                        <small class="text-muted">Total Stream Hours</small>
                                    </div>
                                </div>
                            </div>

                            <div class="card feature-card mt-4">
                                <div class="card-header">
                                    <h6 class="mb-0">Upcoming Streams</h6>
                                </div>
                                <div class="card-body">
                                    <div class="upcoming-stream mb-3">
                                        <h6 class="mb-1">Sunday Morning Service</h6>
                                        <small class="text-muted">Dec 17, 2024 at 11:00 AM</small>
                                    </div>
                                    <div class="upcoming-stream mb-3">
                                        <h6 class="mb-1">Wednesday Bible Study</h6>
                                        <small class="text-muted">Dec 20, 2024 at 7:00 PM</small>
                                    </div>
                                    <button class="btn btn-outline-primary btn-sm w-100" onclick="churchAdmin.manageScheduledStreams()">
                                        Manage Schedule
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            getRecentMediaFiles() {
                return [
                    { id: 'file001', name: 'Christmas_Service_2024.jpg', type: 'image', size: '2.3 MB' },
                    { id: 'file002', name: 'Youth_Event_Video.mp4', type: 'video', size: '45.7 MB' },
                    { id: 'file003', name: 'Worship_Song.mp3', type: 'audio', size: '4.2 MB' },
                    { id: 'file004', name: 'Church_Logo.png', type: 'image', size: '1.8 MB' },
                    { id: 'file005', name: 'Announcement_Slide.pptx', type: 'document', size: '3.1 MB' },
                    { id: 'file006', name: 'Baptism_Photos.zip', type: 'archive', size: '12.4 MB' }
                ];
            }

            getDefaultDocuments() {
                return [
                    {
                        id: 'doc001',
                        name: 'Membership Application Form',
                        type: 'pdf',
                        category: 'Forms & Applications',
                        modified: 'Dec 5, 2024',
                        downloads: 23
                    },
                    {
                        id: 'doc002',
                        name: 'Advent Study Guide',
                        type: 'pdf',
                        category: 'Study Guides',
                        modified: 'Nov 28, 2024',
                        downloads: 156
                    },
                    {
                        id: 'doc003',
                        name: 'Volunteer Handbook',
                        type: 'docx',
                        category: 'Ministry Resources',
                        modified: 'Nov 15, 2024',
                        downloads: 89
                    },
                    {
                        id: 'doc004',
                        name: 'Child Protection Policy',
                        type: 'pdf',
                        category: 'Policies & Procedures',
                        modified: 'Oct 20, 2024',
                        downloads: 45
                    },
                    {
                        id: 'doc005',
                        name: 'Small Group Leader Guide',
                        type: 'pdf',
                        category: 'Ministry Resources',
                        modified: 'Oct 10, 2024',
                        downloads: 67
                    }
                ];
            }

            getFileTypeIcon(type) {
                const icons = {
                    'image': 'image',
                    'video': 'play-circle',
                    'audio': 'music-note',
                    'document': 'file-text',
                    'pdf': 'file-pdf',
                    'docx': 'file-word',
                    'xlsx': 'file-excel',
                    'pptx': 'file-ppt',
                    'archive': 'file-zip'
                };
                return icons[type] || 'file';
            }

            getFileTypeColor(type) {
                const colors = {
                    'image': 'success',
                    'video': 'primary',
                    'audio': 'warning',
                    'document': 'info',
                    'pdf': 'danger',
                    'docx': 'primary',
                    'xlsx': 'success',
                    'pptx': 'warning',
                    'archive': 'secondary'
                };
                return colors[type] || 'secondary';
            }
        }

        // Initialize the Church Admin System
        const churchAdmin = new ChurchAdmin();

        // Setup form submissions
        document.addEventListener('submit', function(e) {
            if (e.target.id === 'memberForm') {
                e.preventDefault();
                churchAdmin.saveMember();
            } else if (e.target.id === 'offeringForm') {
                e.preventDefault();
                churchAdmin.saveOffering();
            } else if (e.target.id === 'eventForm') {
                e.preventDefault();
                churchAdmin.saveEvent();
            } else if (e.target.id === 'bulkEmailForm') {
                e.preventDefault();
                churchAdmin.sendBulkEmailMessage();
            } else if (e.target.id === 'contactForm') {
                e.preventDefault();
                churchAdmin.sendContactMessage();
            }
        });

        // Add saveMember and saveOffering methods to ChurchAdmin
        ChurchAdmin.prototype.saveMember = function() {
            const form = document.getElementById('memberForm');
            if (!form.checkValidity()) {
                form.classList.add('was-validated');
                return;
            }

            const memberData = {
                id: this.generateId(),
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                membershipType: document.getElementById('membershipType').value,
                joinDate: document.getElementById('joinDate').value,
                address: document.getElementById('address').value,
                notes: document.getElementById('notes').value,
                ministries: Array.from(document.querySelectorAll('#memberForm input[type="checkbox"]:checked')).map(cb => cb.value),
                status: 'active',
                createdAt: new Date().toISOString()
            };

            this.saveToStorage('members', memberData);

            const modal = bootstrap.Modal.getInstance(document.getElementById('addMemberModal'));
            modal.hide();

            uiComponents.showToast('Member added successfully!', 'success');

            // Refresh if on members page
            if (currentSection === 'members') {
                this.loadSection('members', false);
            }
        };

        ChurchAdmin.prototype.saveOffering = function() {
            const form = document.getElementById('offeringForm');
            if (!form.checkValidity()) {
                form.classList.add('was-validated');
                return;
            }

            const cash = parseFloat(document.getElementById('cashAmount').value) || 0;
            const check = parseFloat(document.getElementById('checkAmount').value) || 0;
            const online = parseFloat(document.getElementById('onlineAmount').value) || 0;

            const offeringData = {
                id: this.generateId(),
                date: document.getElementById('offeringDate').value,
                service: document.getElementById('service').value,
                cashAmount: cash,
                checkAmount: check,
                onlineAmount: online,
                totalAmount: cash + check + online,
                fund: document.getElementById('fund').value,
                notes: document.getElementById('offeringNotes').value,
                recordedBy: this.currentUser?.name || 'Admin',
                recordedAt: new Date().toISOString()
            };

            this.saveToStorage('offerings', offeringData);

            const modal = bootstrap.Modal.getInstance(document.getElementById('recordOfferingModal'));
            modal.hide();

            uiComponents.showToast('Offering recorded successfully!', 'success');

            // Refresh if on offerings page
            if (currentSection === 'offerings') {
                this.loadSection('offerings', false);
            }
        };

        ChurchAdmin.prototype.saveEvent = function() {
            const form = document.getElementById('eventForm');
            if (!form.checkValidity()) {
                form.classList.add('was-validated');
                return;
            }

            const eventData = {
                id: this.generateId(),
                title: document.getElementById('eventTitle').value,
                date: document.getElementById('eventDate').value,
                time: document.getElementById('eventTime').value,
                location: document.getElementById('eventLocation').value,
                description: document.getElementById('eventDescription').value,
                category: document.getElementById('eventCategory').value,
                capacity: document.getElementById('eventCapacity').value || null,
                contact: document.getElementById('eventContact').value,
                requiresRSVP: document.getElementById('requiresRSVP').checked,
                attendees: 0,
                createdBy: this.currentUser?.name || 'Admin',
                createdAt: new Date().toISOString()
            };

            this.saveToStorage('events', eventData);

            const modal = bootstrap.Modal.getInstance(document.getElementById('createEventModal'));
            modal.hide();

            uiComponents.showToast('Event created successfully!', 'success');

            // Refresh if on events page
            if (currentSection === 'events') {
                this.loadSection('events', false);
            }
        };

        ChurchAdmin.prototype.sendBulkEmailMessage = function() {
            const form = document.getElementById('bulkEmailForm');
            if (!form.checkValidity()) {
                form.classList.add('was-validated');
                return;
            }

            const emailData = {
                recipients: document.getElementById('emailRecipients').value,
                subject: document.getElementById('emailSubject').value,
                content: document.getElementById('emailContent').value,
                template: document.getElementById('emailTemplate').value,
                sendTest: document.getElementById('sendTestEmail').checked,
                sentBy: this.currentUser?.name || 'Admin',
                sentAt: new Date().toISOString()
            };

            // Simulate sending email
            uiComponents.showLoading();

            setTimeout(() => {
                uiComponents.hideLoading();

                const modal = bootstrap.Modal.getInstance(document.getElementById('bulkEmailModal'));
                modal.hide();

                const recipientCount = this.getRecipientCount(emailData.recipients);
                uiComponents.showToast(`Email sent successfully to ${recipientCount} recipients!`, 'success');
            }, 2000);
        };

        ChurchAdmin.prototype.sendContactMessage = function() {
            const form = document.getElementById('contactForm');
            const method = document.getElementById('contactMethod').value;
            const subject = document.getElementById('contactSubject').value;
            const message = document.getElementById('contactMessage').value;

            if (!subject || !message) {
                uiComponents.showToast('Please fill in all required fields.', 'error');
                return;
            }

            // Simulate sending message
            uiComponents.showLoading();

            setTimeout(() => {
                uiComponents.hideLoading();

                const modal = bootstrap.Modal.getInstance(document.getElementById('contactMemberModal'));
                modal.hide();

                uiComponents.showToast(`${method.charAt(0).toUpperCase() + method.slice(1)} sent successfully!`, 'success');
            }, 1000);
        };

        ChurchAdmin.prototype.getRecipientCount = function(recipientGroup) {
            const counts = {
                'all-members': 487,
                'newsletter-subscribers': 456,
                'youth-families': 45,
                'volunteers': 89,
                'ministry-leaders': 23,
                'custom': 1
            };
            return counts[recipientGroup] || 0;
        };

        // Add additional ministry and communication methods
        ChurchAdmin.prototype.createNewMinistry = function() {
            const modal = uiComponents.createModal(
                'createMinistryModal',
                'Create New Ministry',
                `
                    <form id="ministryForm" class="needs-validation" novalidate>
                        <div class="mb-3">
                            <label for="ministryName" class="form-label">Ministry Name *</label>
                            <input type="text" class="form-control" id="ministryName" required>
                        </div>
                        <div class="mb-3">
                            <label for="ministryCategory" class="form-label">Category *</label>
                            <select class="form-select" id="ministryCategory" required>
                                <option value="">Select category...</option>
                                <option value="youth">Youth</option>
                                <option value="children">Children</option>
                                <option value="worship">Worship</option>
                                <option value="outreach">Outreach</option>
                                <option value="prayer">Prayer</option>
                                <option value="hospitality">Hospitality</option>
                                <option value="education">Education</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="ministryLeader" class="form-label">Ministry Leader</label>
                            <input type="text" class="form-control" id="ministryLeader">
                        </div>
                        <div class="mb-3">
                            <label for="ministryDescription" class="form-label">Description</label>
                            <textarea class="form-control" id="ministryDescription" rows="3"></textarea>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-plus me-1"></i>Create Ministry
                            </button>
                        </div>
                    </form>
                `
            );
            modal.show();
        };

        ChurchAdmin.prototype.createAnnouncement = function() {
            const modal = uiComponents.createModal(
                'createAnnouncementModal',
                'Create Announcement',
                `
                    <form id="announcementForm" class="needs-validation" novalidate>
                        <div class="mb-3">
                            <label for="announcementTitle" class="form-label">Title *</label>
                            <input type="text" class="form-control" id="announcementTitle" required>
                        </div>
                        <div class="mb-3">
                            <label for="announcementContent" class="form-label">Content *</label>
                            <textarea class="form-control" id="announcementContent" rows="4" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="announcementPriority" class="form-label">Priority</label>
                            <select class="form-select" id="announcementPriority">
                                <option value="normal">Normal</option>
                                <option value="high">High</option>
                                <option value="urgent">Urgent</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Publish To:</label>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="publishWebsite" checked>
                                <label class="form-check-label" for="publishWebsite">Website</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="publishEmail">
                                <label class="form-check-label" for="publishEmail">Email Newsletter</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="publishSocial">
                                <label class="form-check-label" for="publishSocial">Social Media</label>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-megaphone me-1"></i>Publish Announcement
                            </button>
                        </div>
                    </form>
                `
            );
            modal.show();
        };

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Check for hash in URL
            const hash = window.location.hash.substring(1);
            if (hash && hash !== 'home') {
                churchAdmin.loadSection(hash);
            }
        });

        console.log('Grace Community Church Management System Loaded Successfully!');
    </script>
</body>
</html>
