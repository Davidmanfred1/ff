<!-- Events Section -->
<section id="events" class="content-section">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h2>Event Management</h2>
                <p class="mb-0">Manage church events, registrations, and attendance tracking</p>
            </div>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="createNewEvent()">
                    <i class="bi bi-plus me-1"></i>Create Event
                </button>
                <button class="btn btn-outline-primary" onclick="manageRecurringEvents()">
                    <i class="bi bi-arrow-repeat me-1"></i>Recurring Events
                </button>
                <button class="btn btn-outline-secondary" onclick="exportEventData()">
                    <i class="bi bi-download me-1"></i>Export Data
                </button>
            </div>
        </div>

        <!-- Event Filters -->
        <div class="row mb-4">
            <div class="col-lg-8">
                <div class="btn-group" role="group" aria-label="Event filters">
                    <input type="radio" class="btn-check" name="eventFilter" id="allEvents" autocomplete="off" checked>
                    <label class="btn btn-outline-primary" for="allEvents">All Events</label>

                    <input type="radio" class="btn-check" name="eventFilter" id="thisWeek" autocomplete="off">
                    <label class="btn btn-outline-primary" for="thisWeek">This Week</label>

                    <input type="radio" class="btn-check" name="eventFilter" id="thisMonth" autocomplete="off">
                    <label class="btn btn-outline-primary" for="thisMonth">This Month</label>

                    <input type="radio" class="btn-check" name="eventFilter" id="ministryEvents" autocomplete="off">
                    <label class="btn btn-outline-primary" for="ministryEvents">Ministry Events</label>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="Search events..." id="eventSearch">
                    <button class="btn btn-outline-secondary" type="button">
                        <i class="bi bi-search"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Calendar View Toggle -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h4>Events Calendar</h4>
            <div class="btn-group" role="group">
                <input type="radio" class="btn-check" name="viewMode" id="listView" autocomplete="off" checked>
                <label class="btn btn-outline-primary" for="listView">
                    <i class="bi bi-list-ul me-1"></i>List
                </label>
                <input type="radio" class="btn-check" name="viewMode" id="calendarView" autocomplete="off">
                <label class="btn btn-outline-primary" for="calendarView">
                    <i class="bi bi-calendar3 me-1"></i>Calendar
                </label>
            </div>
        </div>

        <!-- Events List View -->
        <div id="eventsListView">
            <div class="row" id="eventsList">
                <!-- Featured Event -->
                <div class="col-12 mb-4">
                    <div class="card event-card featured-event">
                        <div class="row g-0">
                            <div class="col-md-4">
                                <img src="assets/images/christmas-service.jpg" class="img-fluid h-100 object-fit-cover" alt="Christmas Service">
                            </div>
                            <div class="col-md-8">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-start">
                                        <div>
                                            <span class="badge bg-warning text-dark mb-2">Featured Event</span>
                                            <h4 class="card-title">Christmas Eve Candlelight Service</h4>
                                            <p class="text-muted mb-2">
                                                <i class="bi bi-calendar me-2"></i>December 24, 2024
                                                <i class="bi bi-clock ms-3 me-2"></i>7:00 PM
                                                <i class="bi bi-geo-alt ms-3 me-2"></i>Main Sanctuary
                                            </p>
                                        </div>
                                        <button class="btn btn-primary" onclick="rsvpEvent('christmas-eve-2024')">
                                            <i class="bi bi-calendar-check me-1"></i>RSVP
                                        </button>
                                    </div>
                                    <p class="card-text">Join us for a beautiful candlelight service as we celebrate the birth of our Savior. This special evening includes traditional carols, scripture readings, and a message of hope.</p>
                                    <div class="d-flex align-items-center">
                                        <span class="text-success me-3">
                                            <i class="bi bi-people me-1"></i>127 attending
                                        </span>
                                        <button class="btn btn-outline-secondary btn-sm me-2" onclick="shareEvent('christmas-eve-2024')">
                                            <i class="bi bi-share me-1"></i>Share
                                        </button>
                                        <button class="btn btn-outline-info btn-sm" onclick="addToCalendar('christmas-eve-2024')">
                                            <i class="bi bi-calendar-plus me-1"></i>Add to Calendar
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Regular Events -->
                <div class="col-lg-6 mb-4">
                    <div class="card event-card">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <div class="event-date-badge">
                                    <div class="day">15</div>
                                    <div class="month">DEC</div>
                                </div>
                                <span class="badge bg-info">Youth Ministry</span>
                            </div>
                            <h5 class="card-title">Youth Christmas Party</h5>
                            <p class="text-muted small mb-2">
                                <i class="bi bi-clock me-1"></i>6:30 PM - 9:00 PM
                                <i class="bi bi-geo-alt ms-2 me-1"></i>Youth Center
                            </p>
                            <p class="card-text">Fun-filled evening with games, food, and fellowship for our youth group members and friends.</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-success">
                                    <i class="bi bi-people me-1"></i>23 attending
                                </small>
                                <button class="btn btn-sm btn-primary" onclick="rsvpEvent('youth-christmas-2024')">
                                    RSVP
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6 mb-4">
                    <div class="card event-card">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <div class="event-date-badge">
                                    <div class="day">18</div>
                                    <div class="month">DEC</div>
                                </div>
                                <span class="badge bg-success">Community</span>
                            </div>
                            <h5 class="card-title">Community Food Drive</h5>
                            <p class="text-muted small mb-2">
                                <i class="bi bi-clock me-1"></i>10:00 AM - 2:00 PM
                                <i class="bi bi-geo-alt ms-2 me-1"></i>Church Parking Lot
                            </p>
                            <p class="card-text">Help us collect food donations for local families in need during the holiday season.</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-success">
                                    <i class="bi bi-people me-1"></i>45 volunteers
                                </small>
                                <button class="btn btn-sm btn-success" onclick="volunteerEvent('food-drive-2024')">
                                    Volunteer
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6 mb-4">
                    <div class="card event-card">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <div class="event-date-badge">
                                    <div class="day">22</div>
                                    <div class="month">DEC</div>
                                </div>
                                <span class="badge bg-warning text-dark">Worship</span>
                            </div>
                            <h5 class="card-title">Christmas Concert</h5>
                            <p class="text-muted small mb-2">
                                <i class="bi bi-clock me-1"></i>7:00 PM - 8:30 PM
                                <i class="bi bi-geo-alt ms-2 me-1"></i>Main Sanctuary
                            </p>
                            <p class="card-text">Join our choir and worship team for an evening of beautiful Christmas music and celebration.</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-success">
                                    <i class="bi bi-people me-1"></i>89 attending
                                </small>
                                <button class="btn btn-sm btn-primary" onclick="rsvpEvent('christmas-concert-2024')">
                                    RSVP
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6 mb-4">
                    <div class="card event-card">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <div class="event-date-badge">
                                    <div class="day">31</div>
                                    <div class="month">DEC</div>
                                </div>
                                <span class="badge bg-primary">Special Service</span>
                            </div>
                            <h5 class="card-title">New Year's Eve Prayer Service</h5>
                            <p class="text-muted small mb-2">
                                <i class="bi bi-clock me-1"></i>10:00 PM - 12:30 AM
                                <i class="bi bi-geo-alt ms-2 me-1"></i>Main Sanctuary
                            </p>
                            <p class="card-text">End the year in prayer and reflection as we prepare our hearts for the new year ahead.</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-success">
                                    <i class="bi bi-people me-1"></i>156 attending
                                </small>
                                <button class="btn btn-sm btn-primary" onclick="rsvpEvent('new-year-prayer-2024')">
                                    RSVP
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Calendar View (Hidden by default) -->
        <div id="eventsCalendarView" style="display: none;">
            <div id="eventCalendar">
                <!-- Calendar will be generated by JavaScript -->
            </div>
        </div>

        <!-- Recurring Events -->
        <div class="mt-5">
            <h4 class="text-primary mb-4">Regular Weekly Events</h4>
            <div class="row g-3">
                <div class="col-lg-4 col-md-6">
                    <div class="card border-primary">
                        <div class="card-body text-center">
                            <i class="bi bi-book text-primary fs-2 mb-2"></i>
                            <h6>Bible Study</h6>
                            <p class="small text-muted mb-2">Every Wednesday, 7:00 PM</p>
                            <p class="small">Deep dive into God's word with fellow believers</p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6">
                    <div class="card border-info">
                        <div class="card-body text-center">
                            <i class="bi bi-people text-info fs-2 mb-2"></i>
                            <h6>Youth Group</h6>
                            <p class="small text-muted mb-2">Every Friday, 6:30 PM</p>
                            <p class="small">Fun, fellowship, and faith for teens</p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6">
                    <div class="card border-success">
                        <div class="card-body text-center">
                            <i class="bi bi-cup-hot text-success fs-2 mb-2"></i>
                            <h6>Coffee Fellowship</h6>
                            <p class="small text-muted mb-2">Every Sunday, 10:00 AM</p>
                            <p class="small">Connect with others over coffee and conversation</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Event Details Modal -->
<div class="modal fade" id="eventDetailsModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="eventModalTitle">Event Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body" id="eventModalBody">
                <!-- Event details will be loaded here -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="eventRsvpBtn">RSVP</button>
            </div>
        </div>
    </div>
</div>

<!-- RSVP Modal -->
<div class="modal fade" id="rsvpModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">RSVP for Event</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="rsvpForm">
                    <div class="mb-3">
                        <label for="rsvpName" class="form-label">Full Name *</label>
                        <input type="text" class="form-control" id="rsvpName" required>
                    </div>
                    <div class="mb-3">
                        <label for="rsvpEmail" class="form-label">Email Address *</label>
                        <input type="email" class="form-control" id="rsvpEmail" required>
                    </div>
                    <div class="mb-3">
                        <label for="rsvpPhone" class="form-label">Phone Number</label>
                        <input type="tel" class="form-control" id="rsvpPhone">
                    </div>
                    <div class="mb-3">
                        <label for="rsvpGuests" class="form-label">Number of Guests</label>
                        <select class="form-select" id="rsvpGuests">
                            <option value="0">Just me</option>
                            <option value="1">1 guest</option>
                            <option value="2">2 guests</option>
                            <option value="3">3 guests</option>
                            <option value="4">4+ guests</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="rsvpNotes" class="form-label">Special Notes or Dietary Restrictions</label>
                        <textarea class="form-control" id="rsvpNotes" rows="3"></textarea>
                    </div>
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="rsvpReminder">
                        <label class="form-check-label" for="rsvpReminder">
                            Send me a reminder 24 hours before the event
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" form="rsvpForm" class="btn btn-primary">
                    <i class="bi bi-check-circle me-1"></i>Confirm RSVP
                </button>
            </div>
        </div>
    </div>
</div>

<script>
// Event Management JavaScript
document.addEventListener('DOMContentLoaded', function() {
    // Sample events data
    const sampleEvents = [
        {
            id: 'christmas-eve-2024',
            title: 'Christmas Eve Candlelight Service',
            date: '2024-12-24',
            time: '7:00 PM',
            location: 'Main Sanctuary',
            description: 'Join us for a beautiful candlelight service as we celebrate the birth of our Savior.',
            category: 'Special Service',
            attendees: 127,
            featured: true
        },
        {
            id: 'youth-christmas-2024',
            title: 'Youth Christmas Party',
            date: '2024-12-15',
            time: '6:30 PM',
            location: 'Youth Center',
            description: 'Fun-filled evening with games, food, and fellowship for our youth group.',
            category: 'Youth Ministry',
            attendees: 23
        }
    ];

    // Initialize event filters
    setupEventFilters();
    setupViewToggle();
    setupEventSearch();
    setupRSVPForm();
});

function setupEventFilters() {
    const filterButtons = document.querySelectorAll('input[name="eventFilter"]');
    filterButtons.forEach(button => {
        button.addEventListener('change', function() {
            filterEvents(this.id);
        });
    });
}

function setupViewToggle() {
    const viewButtons = document.querySelectorAll('input[name="viewMode"]');
    viewButtons.forEach(button => {
        button.addEventListener('change', function() {
            toggleEventView(this.id);
        });
    });
}

function setupEventSearch() {
    const searchInput = document.getElementById('eventSearch');
    if (searchInput) {
        searchInput.addEventListener('input', function() {
            searchEvents(this.value);
        });
    }
}

function setupRSVPForm() {
    const rsvpForm = document.getElementById('rsvpForm');
    if (rsvpForm) {
        rsvpForm.addEventListener('submit', function(e) {
            e.preventDefault();
            handleRSVP(this);
        });
    }
}

function filterEvents(filterType) {
    console.log('Filtering events by:', filterType);
    // Implement event filtering logic
}

function toggleEventView(viewType) {
    const listView = document.getElementById('eventsListView');
    const calendarView = document.getElementById('eventsCalendarView');
    
    if (viewType === 'calendarView') {
        listView.style.display = 'none';
        calendarView.style.display = 'block';
        loadEventCalendar();
    } else {
        listView.style.display = 'block';
        calendarView.style.display = 'none';
    }
}

function searchEvents(searchTerm) {
    const eventCards = document.querySelectorAll('.event-card');
    eventCards.forEach(card => {
        const text = card.textContent.toLowerCase();
        card.closest('.col-lg-6, .col-12').style.display = 
            text.includes(searchTerm.toLowerCase()) ? 'block' : 'none';
    });
}

function rsvpEvent(eventId) {
    const modal = new bootstrap.Modal(document.getElementById('rsvpModal'));
    modal.show();
    
    // Store event ID for form submission
    document.getElementById('rsvpForm').setAttribute('data-event-id', eventId);
}

function handleRSVP(form) {
    const eventId = form.getAttribute('data-event-id');
    const formData = new FormData(form);
    
    // Show loading state
    const submitBtn = form.querySelector('button[type="submit"]');
    const originalText = submitBtn.innerHTML;
    submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Processing...';
    submitBtn.disabled = true;
    
    // Simulate RSVP processing
    setTimeout(() => {
        // Reset button
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
        
        // Hide modal
        const modal = bootstrap.Modal.getInstance(document.getElementById('rsvpModal'));
        modal.hide();
        
        // Show success message
        uiComponents.showToast('RSVP confirmed! You will receive a confirmation email shortly.', 'success');
        
        // Reset form
        form.reset();
    }, 2000);
}

function shareEvent(eventId) {
    if (navigator.share) {
        navigator.share({
            title: 'Grace Community Church Event',
            text: 'Join us for this upcoming event!',
            url: window.location.href + '#event-' + eventId
        });
    } else {
        // Fallback for browsers without Web Share API
        const url = window.location.href + '#event-' + eventId;
        navigator.clipboard.writeText(url).then(() => {
            uiComponents.showToast('Event link copied to clipboard!', 'success');
        });
    }
}

function addToCalendar(eventId) {
    // Generate calendar file or link
    uiComponents.showToast('Calendar event created!', 'success');
}

function volunteerEvent(eventId) {
    // Open volunteer signup
    rsvpEvent(eventId);
}

function loadEventCalendar() {
    const calendarContainer = document.getElementById('eventCalendar');
    if (calendarContainer) {
        calendarContainer.innerHTML = uiComponents.createCalendar([]);
    }
}
</script>
